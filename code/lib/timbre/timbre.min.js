(function(u){var t=function(){return k.apply(null,arguments)},h=Array.prototype.slice,n=[8E3,11025,12E3,16E3,22050,24E3,32E3,44100,48E3],g=[32,64,128,256],e=null,a={},d={},b="undefined"!==typeof window?"browser":"undefined"!==typeof module&&module.exports?"node":"unknown",c="browser"===b&&/(iPhone|iPad|iPod|Android)/i.test(navigator.userAgent),f=!1,m=120,k=function(){var p=h.call(arguments),v=p[0],q;switch(typeof v){case "string":if(a[v])var x=new a[v](p.slice(1));else if(d[v])x=d[v](p.slice(1));
else if(q=/^(.+?)(?:\.(ar|kr))?$/.exec(v))if(v=q[1],a[v]?x=new a[v](p.slice(1)):d[v]&&(x=d[v](p.slice(1))),x&&q[2])x[q[2]]();break;case "number":x=new L(p);break;case "boolean":x=new K(p);break;case "function":x=new N(p);break;case "object":if(null!==v){if(v instanceof D)return v;if(v.context instanceof D)return v.context;w(v)?x=new R(p):r(v)&&(x=new Q(p))}}x===u&&(x=new H(p.slice(1)),console.warn('T("'+v+'") is not defined.'));p=x._;p.originkey=v;v=x._.meta;for(var y,A=x;null!==A&&A.constructor!==
Object;){q=Object.getOwnPropertyNames(A);for(var B=0,I=q.length;B<I;++B)if(!v[q[B]])if(/^(constructor$|process$|_)/.test(q[B]))v[q[B]]="ignore";else if(y=Object.getOwnPropertyDescriptor(A,q[B]),"function"===typeof y.value)v[q[B]]="function";else if(y.get||y.set)v[q[B]]="property";A=Object.getPrototypeOf(A)}p.meta=v;p.emit("init");return x};Object.defineProperties(t,{version:{value:"14.11.25"},envtype:{value:b},envmobile:{value:c},env:{get:function(){return e.impl.env}},samplerate:{get:function(){return e.samplerate}},
channels:{get:function(){return e.channels}},cellsize:{get:function(){return e.cellsize}},currentTime:{get:function(){return e.currentTime}},isPlaying:{get:function(){return 1===e.status}},isRecording:{get:function(){return 3===e.status}},amp:{set:function(p){"number"===typeof p&&(e.amp=p)},get:function(){return e.amp}},bpm:{set:function(p){"number"===typeof p&&5<=p&&300>=p&&(m=p)},get:function(){return m}}});t.bind=function(p,v){e.bind(p,v);return t};t.setup=function(p){e.setup(p);return t};t.play=
function(){e.play();return t};t.pause=function(){e.pause();return t};t.reset=function(){e.reset();e.events.emit("reset");return t};t.on=t.addListener=function(p,v){e.on(p,v);return t};t.once=function(p,v){e.once(p,v);return t};t.off=t.removeListener=function(p,v){e.off(p,v);return t};t.removeAllListeners=function(p){e.removeAllListeners(p);return t};t.listeners=function(p){return e.listeners(p)};t.rec=function(){return e.rec.apply(e,arguments)};t.timevalue=function(){var p=function(v){var q=m;if(v=
/^bpm(\d+(?:\.\d+)?)/i.exec(v))q=Math.max(5,Math.min(300,+(v[1]||0)));return q};return function(v){var q;if(q=/^(\d+(?:\.\d+)?)Hz$/i.exec(v))return 0===+q[1]?0:1E3/+q[1];if(q=/L(\d+)?(\.*)$/i.exec(v))return v=60/p(v)*(4/(q[1]||4))*1E3,v*=2-1/Math.pow(2,(q[2]||"").length);if(q=/^(\d+(?:\.\d+)?|\.(?:\d+))(min|sec|m)s?$/i.exec(v))switch(q[2]){case "min":return 6E4*+(q[1]||0);case "sec":return 1E3*+(q[1]||0);case "m":return+(q[1]||0)}if(q=/^(?:([0-5]?[0-9]):)?(?:([0-5]?[0-9]):)(?:([0-5]?[0-9]))(?:\.([0-9]{1,3}))?$/.exec(v)){var x=
3600*(q[1]||0)+60*(q[2]||0)+(q[3]||0);return x=1E3*x+(((q[4]||"")+"00").substr(0,3)|0)}return(q=/(\d+)\.(\d+)\.(\d+)$/i.exec(v))?(x=480*(4*q[1]+ +q[2])+ +q[3],60/p(v)*(x/480)*1E3):(q=/(\d+)ticks$/i.exec(v))?60/p(v)*(q[1]/480)*1E3:(q=/^(\d+)samples(?:\/(\d+)Hz)?$/i.exec(v))?1E3*q[1]/(q[2]||t.samplerate):0}}();var l=t.fn={SignalArray:Float32Array,currentTimeIncr:0,emptycell:null,FINISHED_STATE:0,PLAYING_STATE:1,UNSCHEDULED_STATE:2,SCHEDULED_STATE:3},r=l.isArray=Array.isArray,w=l.isDictionary=function(p){return"object"===
typeof p&&p.constructor===Object};l.nop=function(){return this};l.isSignalArray=function(p){return p instanceof l.SignalArray||Array.isArray(p)&&p.__klass&&2===p.__klass.type?!0:!1};l.extend=function(p,v){function q(){this.constructor=p}v=v||D;for(var x in v)v.hasOwnProperty(x)&&(p[x]=v[x]);q.prototype=v.prototype;p.prototype=new q;p.__super__=v.prototype;return p};l.constructorof=function(p,v){for(p=p&&p.prototype;p;){if(p===v.prototype)return!0;p=Object.getPrototypeOf(p)}return!1};l.register=function(p,
v){l.constructorof(v,D)?a[p]=v:d[p]=v};l.alias=function(p,v){a[v]?a[p]=a[v]:d[v]&&(d[p]=d[v])};l.getClass=function(p){return a[p]};l.pointer=function(p,v,q){v=p.byteOffset+v*p.constructor.BYTES_PER_ELEMENT;return"number"===typeof q?new p.constructor(p.buffer,v,q):new p.constructor(p.buffer,v)};l.nextTick=function(p){e.nextTick(p);return t};l.fixAR=function(p){p._.ar=!0;p._.aronly=!0};l.fixKR=function(p){p._.ar=!1;p._.kronly=!0};l.changeWithValue=function(){var p=this._;p=p.value*p.mul+p.add;isNaN(p)&&
(p=0);for(var v=this.cells[0],q=0,x=v.length;q<x;++q)v[q]=p};l.changeWithValue.unremovable=!0;l.clone=function(p){var v=new p.constructor([]);v._.ar=p._.ar;v._.mul=p._.mul;v._.add=p._.add;v._.bypassed=p._.bypassed;return v};l.timer=function(){var p=function(q){return function(){-1===e.timers.indexOf(q)&&(e.timers.push(q),e.events.emit("addObject"),q._.emit("start"),l.buddies_start(q))}},v=function(q){return function(){var x=e.timers.indexOf(q);-1!==x&&(e.timers.splice(x,1),q._.emit("stop"),e.events.emit("removeObject"),
l.buddies_stop(q))}};return function(q){var x=p(q),y=v(q);q.nodeType=D.TIMER;q.start=function(){e.nextTick(x);return q};q.stop=function(){e.nextTick(y);return q};return q}}();l.listener=function(){var p=function(q){return function(){-1===e.listeners.indexOf(q)&&(e.listeners.push(q),e.events.emit("addObject"),q._.emit("listen"),l.buddies_start(q))}},v=function(q){return function(){var x=e.listeners.indexOf(q);-1!==x&&(e.listeners.splice(x,1),q._.emit("unlisten"),e.events.emit("removeObject"),l.buddies_stop(q))}};
return function(q){var x=p(q),y=v(q);q.nodeType=D.LISTENER;q.listen=function(A){arguments.length&&q.append.apply(q,arguments);q.nodes.length&&e.nextTick(x);return q};q.unlisten=function(){arguments.length&&q.remove.apply(q,arguments);q.nodes.length||e.nextTick(y);return q};return q}}();l.make_onended=function(p,v){return function(){p.playbackState=0;if("number"===typeof v)for(var q=p.cells[0],x=p.cells[1],y=p.cells[2],A=0,B=x.length;A<B;++A)q[0]=x[A]=y[A]=v;p._.emit("ended")}};l.inputSignalAR=function(p){var v=
p.cells[0],q=p.cells[1],x=p.cells[2],y=p.nodes,A=y.length,B,I=v.length,G=p.tickID;if(2===p.numChannels){var J=!0;if(0!==A){for(p=0;p<A;++p)if(1===y[p].playbackState){y[p].process(G);q.set(y[p].cells[1]);x.set(y[p].cells[2]);J=!1;++p;break}for(;p<A;++p)if(1===y[p].playbackState){y[p].process(G);v=y[p].cells[1];var M=y[p].cells[2];for(B=I;B;)B-=8,q[B]+=v[B],x[B]+=M[B],q[B+1]+=v[B+1],x[B+1]+=M[B+1],q[B+2]+=v[B+2],x[B+2]+=M[B+2],q[B+3]+=v[B+3],x[B+3]+=M[B+3],q[B+4]+=v[B+4],x[B+4]+=M[B+4],q[B+5]+=v[B+
5],x[B+5]+=M[B+5],q[B+6]+=v[B+6],x[B+6]+=M[B+6],q[B+7]+=v[B+7],x[B+7]+=M[B+7]}}J&&(q.set(l.emptycell),x.set(l.emptycell))}else{J=!0;if(0!==A){for(p=0;p<A;++p)if(1===y[p].playbackState){y[p].process(G);v.set(y[p].cells[0]);J=!1;++p;break}for(;p<A;++p)if(1===y[p].playbackState)for(q=y[p].process(G).cells[0],B=I;B;)B-=8,v[B]+=q[B],v[B+1]+=q[B+1],v[B+2]+=q[B+2],v[B+3]+=q[B+3],v[B+4]+=q[B+4],v[B+5]+=q[B+5],v[B+6]+=q[B+6],v[B+7]+=q[B+7]}J&&v.set(l.emptycell)}};l.inputSignalKR=function(p){var v=p.nodes,
q=v.length,x=p.tickID,y=0;for(p=0;p<q;++p)1===v[p].playbackState&&(y+=v[p].process(x).cells[0][0]);return y};l.outputSignalAR=function(p){var v=p.cells[0],q=p.cells[1],x=p.cells[2],y=p._.mul,A=p._.add;if(2===p.numChannels)for(p=v.length;p;)p-=8,q[p]=q[p]*y+A,x[p]=x[p]*y+A,q[p+1]=q[p+1]*y+A,x[p+1]=x[p+1]*y+A,q[p+2]=q[p+2]*y+A,x[p+2]=x[p+2]*y+A,q[p+3]=q[p+3]*y+A,x[p+3]=x[p+3]*y+A,q[p+4]=q[p+4]*y+A,x[p+4]=x[p+4]*y+A,q[p+5]=q[p+5]*y+A,x[p+5]=x[p+5]*y+A,q[p+6]=q[p+6]*y+A,x[p+6]=x[p+6]*y+A,q[p+7]=q[p+7]*
y+A,x[p+7]=x[p+7]*y+A,v[p]=.5*(q[p]+x[p]),v[p+1]=.5*(q[p+1]+x[p+1]),v[p+2]=.5*(q[p+2]+x[p+2]),v[p+3]=.5*(q[p+3]+x[p+3]),v[p+4]=.5*(q[p+4]+x[p+4]),v[p+5]=.5*(q[p+5]+x[p+5]),v[p+6]=.5*(q[p+6]+x[p+6]),v[p+7]=.5*(q[p+7]+x[p+7]);else if(1!==y||0!==A)for(p=v.length;p;)p-=8,v[p]=v[p]*y+A,v[p+1]=v[p+1]*y+A,v[p+2]=v[p+2]*y+A,v[p+3]=v[p+3]*y+A,v[p+4]=v[p+4]*y+A,v[p+5]=v[p+5]*y+A,v[p+6]=v[p+6]*y+A,v[p+7]=v[p+7]*y+A};l.outputSignalKR=function(p){var v=p.cells[0],q=p.cells[1],x=p.cells[2],y=v[0]*p._.mul+p._.add;
if(2===p.numChannels)for(p=v.length;p;)p-=8,v[p]=v[p+1]=v[p+2]=v[p+3]=v[p+4]=v[p+5]=v[p+6]=v[p+7]=q[p]=q[p+1]=q[p+2]=q[p+3]=q[p+4]=q[p+5]=q[p+6]=q[p+7]=x[p]=x[p+1]=x[p+2]=x[p+3]=x[p+4]=x[p+5]=x[p+6]=x[p+7]=y;else for(p=v.length;p;)p-=8,v[p]=v[p+1]=v[p+2]=v[p+3]=v[p+4]=v[p+5]=v[p+6]=v[p+7]=y};l.buddies_start=function(p){p=p._.buddies;var v;var q=0;for(v=p.length;q<v;++q){var x=p[q];switch(x.nodeType){case D.DSP:x.play();break;case D.TIMER:x.start();break;case D.LISTENER:x.listen()}}};l.buddies_stop=
function(p){p=p._.buddies;var v;var q=0;for(v=p.length;q<v;++q){var x=p[q];switch(x.nodeType){case D.DSP:x.pause();break;case D.TIMER:x.stop();break;case D.LISTENER:x.unlisten()}}};l.fix_iOS6_1_problem=function(p){e.fix_iOS6_1_problem(p)};var z=t.modules={},C=z.EventEmitter=function(){function p(q){this.context=q;this.events={}}var v=p.prototype;v.emit=function(q){var x=this.events[q];if(!x)return!1;if("function"===typeof x){switch(arguments.length){case 1:x.call(this.context);break;case 2:x.call(this.context,
arguments[1]);break;case 3:x.call(this.context,arguments[1],arguments[2]);break;default:var y=h.call(arguments,1);x.apply(this.context,y)}return!0}if(r(x)){y=h.call(arguments,1);x=x.slice();for(var A=0,B=x.length;A<B;++A)x[A]instanceof D?x[A].bang.apply(x[A],y):x[A].apply(this.context,y);return!0}if(x instanceof D)y=h.call(arguments,1),x.bang.apply(x,y);else return!1};v.on=function(q,x){if("function"!==typeof x&&!(x instanceof D))throw Error("addListener takes instances of Function or timbre.Object");
var y=this.events;y[q]?r(y[q])?y[q].push(x):y[q]=[y[q],x]:y[q]=x;return this};v.once=function(q,x){var y=this;if("function"===typeof x)var A=function(){y.off(q,A);x.apply(y.context,arguments)};else if(x instanceof D)A=function(){y.off(q,A);x.bang.apply(x,arguments)};else throw Error("once takes instances of Function or timbre.Object");A.listener=x;y.on(q,A);return this};v.off=function(q,x){if("function"!==typeof x&&!(x instanceof D))throw Error("removeListener takes instances of Function or timbre.Object");
var y=this.events;if(!y[q])return this;var A=y[q];if(r(A)){for(var B=-1,I=0,G=A.length;I<G;++I)if(A[I]===x||A[I].listener&&A[I].listener===x){B=I;break}if(0>B)return this;A.splice(B,1);0===A.length&&(y[q]=null)}else if(A===x||A.listener&&A.listener===x)y[q]=null;return this};v.removeAllListeners=function(q){var x=this.events,y=!1,A=x[q];if(r(A))for(var B=A.length;B--;){var I=A[B];I.unremovable?y=!0:this.off(q,I)}else A&&(A.unremovable?y=!0:this.off(q,A));y||(x[q]=null);return this};v.listeners=function(q){var x=
this.events;if(!x[q])return[];x=x[q];if(!r(x))return x.unremovable?[]:[x];x=x.slice();q=[];for(var y=0,A=x.length;y<A;++y)x[y].unremovable||q.push(x[y]);return q};return p}(),F=z.Deferred=function(){function p(A){this.context=A||this;this._state="pending";this._doneList=[];this._failList=[];this._promise=new v(this)}function v(A){this.context=A.context;this.then=A.then;this.done=function(){A.done.apply(A,arguments);return this};this.fail=function(){A.fail.apply(A,arguments);return this};this.pipe=
function(){return A.pipe.apply(A,arguments)};this.always=function(){A.always.apply(A,arguments);return this};this.promise=function(){return this};this.isResolved=function(){return A.isResolved()};this.isRejected=function(){return A.isRejected()}}var q=p.prototype,x=function(A,B,I,G){if("pending"===this._state){this._state=A;A=0;for(var J=B.length;A<J;++A)B[A].apply(I,G);this._doneList=this._failList=null}},y=function(A){return A&&"function"===typeof A.promise};q.resolve=function(){var A=h.call(arguments,
0);x.call(this,"resolved",this._doneList,this.context||this,A);return this};q.resolveWith=function(A){var B=h.call(arguments,1);x.call(this,"resolved",this._doneList,A,B);return this};q.reject=function(){var A=h.call(arguments,0);x.call(this,"rejected",this._failList,this.context||this,A);return this};q.rejectWith=function(A){var B=h.call(arguments,1);x.call(this,"rejected",this._failList,A,B);return this};q.promise=function(){return this._promise};q.done=function(){for(var A=h.call(arguments),B=
"resolved"===this._state,I="pending"===this._state,G=this._doneList,J=0,M=A.length;J<M;++J)if("function"===typeof A[J])if(B)A[J]();else I&&G.push(A[J]);return this};q.fail=function(){for(var A=h.call(arguments),B="rejected"===this._state,I="pending"===this._state,G=this._failList,J=0,M=A.length;J<M;++J)if("function"===typeof A[J])if(B)A[J]();else I&&G.push(A[J]);return this};q.always=function(){this.done.apply(this,arguments);this.fail.apply(this,arguments);return this};q.then=function(A,B){return this.done(A).fail(B)};
q.pipe=function(A,B){var I=this,G=new p(this.context);this.done(function(){var J=A.apply(I.context,arguments);y(J)?J.then(function(){var M=h.call(arguments);G.resolveWith.apply(G,[J].concat(M))}):G.resolveWith(I,J)});this.fail(function(){if("function"===typeof B){var J=B.apply(I.context,arguments);y(J)&&J.fail(function(){var M=h.call(arguments);G.rejectWith.apply(G,[J].concat(M))})}else G.reject.apply(G,arguments)});return G.promise()};q.isResolved=function(){return"resolved"===this._state};q.isRejected=
function(){return"rejected"===this._state};q.state=function(){return this._state};p.when=function(A){var B=0,I=h.call(arguments),G=I.length,J=G;1!==G||y(A)||(J=0);var M=1===J?A:new p,S=function(U,O){return function(X){O[U]=1<arguments.length?h.call(arguments):X;--J||M.resolve.apply(M,O)}};if(1<G)for(var P=Array(G),V=function(){M.reject()};B<G;++B)I[B]&&y(I[B])?I[B].promise().done(S(B,P)).fail(V):(P[B]=I[B],--J);J||M.resolve.apply(M,I);return M.promise()};return p}(),D=t.Object=function(){function p(q,
x){this._={};var y=this._.events=new C(this);this._.emit=function(){return y.emit.apply(y,arguments)};if(w(x[0])){var A=x.shift(),B=A["in"];this.once("init",function(){this.set(A);B&&(r(B)?this.append.apply(this,B):B instanceof p&&this.append(B))})}this.tickID=-1;this.nodes=x.map(t);this.cells=[];this.numChannels=q;switch(q){case 0:this.L=this.R=new E(null);this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 1:this.L=this.R=new E(this);this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;
break;case 2:this.L=new E(this),this.R=new E(this),this.cells[0]=new l.SignalArray(e.cellsize),this.cells[1]=this.L.cell,this.cells[2]=this.R.cell}this.playbackState=1;this.nodeType=p.DSP;this._.ar=!0;this._.mul=1;this._.add=0;this._.dac=null;this._.bypassed=!1;this._.meta={};this._.samplerate=e.samplerate;this._.cellsize=e.cellsize;this._.buddies=[]}p.DSP=1;p.TIMER=2;p.LISTENER=3;var v=p.prototype;Object.defineProperties(v,{isAr:{get:function(){return this._.ar}},isKr:{get:function(){return!this._.ar}},
isBypassed:{get:function(){return this._.bypassed}},isEnded:{get:function(){return!(this.playbackState&1)}},mul:{set:function(q){"number"===typeof q&&(this._.mul=q,this._.emit("setMul",q))},get:function(){return this._.mul}},add:{set:function(q){"number"===typeof q&&(this._.add=q,this._.emit("setAdd",q))},get:function(){return this._.add}},buddies:{set:function(q){r(q)||(q=[q]);this._.buddies=q.filter(function(x){return x instanceof p})},get:function(){return this._.buddies}}});v.toString=function(){return this.constructor.name};
v.valueOf=function(){e.tickID!==this.tickID&&this.process(e.tickID);return this.cells[0][0]};v.append=function(){if(0<arguments.length){var q=h.call(arguments).map(t);this.nodes=this.nodes.concat(q);this._.emit("append",q)}return this};v.appendTo=function(q){q.append(this);return this};v.remove=function(){if(0<arguments.length){for(var q,x=this.nodes,y=[],A=0,B=arguments.length;A<B;++A)-1!==(q=x.indexOf(arguments[A]))&&(y.push(x[q]),x.splice(q,1));0<y.length&&this._.emit("remove",y)}return this};
v.removeFrom=function(q){q.remove(this);return this};v.removeAll=function(){var q=this.nodes.slice();this.nodes=[];0<q.length&&this._.emit("remove",q);return this};v.removeAtIndex=function(q){var x=this.nodes[q];x&&(this.nodes.splice(q,1),this._.emit("remove",[x]));return this};v.postMessage=function(q){this._.emit("message",q);return this};v.to=function(q){if(q instanceof p)q.append(this);else{var x=h.call(arguments);w(x[1])?x.splice(2,0,this):x.splice(1,0,this);q=k.apply(null,x)}return q};v.splice=
function(q,x,y){x?x instanceof p&&(y=x.nodes.indexOf(y),-1!==y&&x.nodes.splice(y,1),q instanceof p?(q.nodes.push(this),x.nodes.push(q)):x.nodes.push(this)):this._.dac&&(q instanceof p?y instanceof p?y._.dac&&(y._.dac._.node=q,q._.dac=y._.dac,y._.dac=null,q.nodes.push(this)):this._.dac&&(this._.dac._.node=q,q._.dac=this._.dac,this._.dac=null,q.nodes.push(this)):y instanceof p&&y._.dac&&(y._.dac._.node=this,this._.dac=y._.dac,y._.dac=null));return this};v.on=v.addListener=function(q,x){this._.events.on(q,
x);return this};v.once=function(q,x){this._.events.once(q,x);return this};v.off=v.removeListener=function(q,x){this._.events.off(q,x);return this};v.removeAllListeners=function(q){this._.events.removeAllListeners(q);return this};v.listeners=function(q){return this._.events.listeners(q)};v.set=function(q,x){var y,A,B=this._.meta;switch(typeof q){case "string":switch(B[q]){case "property":this[q]=x;break;case "function":this[q](x);break;default:for(y=this;null!==y;){if(A=Object.getOwnPropertyDescriptor(y,
q))if("function"===typeof A.value)B[q]="function",this[q](x);else if(A.get||A.set)B[q]="property",this[q]=x;y=Object.getPrototypeOf(y)}}break;case "object":for(y in q)this.set(y,q[y])}return this};v.get=function(q){if("property"===this._.meta[q])return this[q]};v.bang=function(){this._.emit.apply(this,["bang"].concat(h.call(arguments)));return this};v.process=l.nop;v.bypass=function(){this._.bypassed=0===arguments.length?!0:!!arguments[0];return this};v.play=function(){var q=this._.dac;null===q&&
(q=this._.dac=new Y(this));q.play()&&this._.emit.apply(this,["play"].concat(h.call(arguments)));l.buddies_start(this);return this};v.pause=function(){var q=this._.dac;q&&1===q.playbackState&&(q.pause(),this._.dac=null,this._.emit("pause"));l.buddies_stop(this);return this};v.start=v.stop=v.listen=v.unlisten=function(){return this};v.ar=function(){0===arguments.length||arguments[0]?this._.kronly||(this._.ar=!0,this._.emit("ar",!0)):this.kr(!0);return this};v.kr=function(){0===arguments.length||arguments[0]?
this._.aronly||(this._.ar=!1,this._.emit("ar",!1)):this.ar(!0);return this};v.plot="browser"===b?function(q){var x=this._,y=q.target;if(!y)return this;var A=q.width||y.width||320,B=q.height||y.height||240,I=(q.x||0)+.5,G=q.y||0;y=y.getContext("2d");var J=q.foreground!==u?q.foreground:x.plotForeground||"rgb(  0, 128, 255)";var M=q.background!==u?q.background:x.plotBackground||"rgb(255, 255, 255)";var S=q.lineWidth||x.plotLineWidth||1,P=!!x.plotCyclic,V=x.plotData||this.cells[0],U=q.range||x.plotRange||
[-1.2,1.2],O=U[0];U=B/(U[1]-O);var X=A/V.length,ba=V.length;y.save();y.rect(I,G,A,B);null!==M&&(y.fillStyle=M,y.fillRect(I,G,A,B));x.plotBefore&&x.plotBefore.call(this,y,I,G,A,B);if(x.plotBarStyle)for(y.fillStyle=J,M=J=0;M<ba;++M){P=(V[M]-O)*U;var T=B-P;y.fillRect(J+I,T+G,X,P);J+=X}else{y.strokeStyle=J;y.lineWidth=S;y.beginPath();J=0;S=B-(V[0]-O)*U;y.moveTo(J+I,S+G);for(M=1;M<ba;++M)J+=X,T=B-(V[M]-O)*U,y.lineTo(J+I,T+G);P?y.lineTo(J+X+I,S+G):y.lineTo(J+X+I,T+G);y.stroke()}x.plotAfter&&x.plotAfter.call(this,
y,I,G,A,B);if(q=q.border||x.plotBorder)y.strokeStyle="string"===typeof q?q:"#000",y.lineWidth=1,y.strokeRect(I,G,A,B);y.restore();return this}:l.nop;return p}(),E=t.ChannelObject=function(){function p(v){t.Object.call(this,-1,[]);l.fixAR(this);this._.parent=v;this.cell=new l.SignalArray(e.cellsize);this.L=this.R=this;this.cells[0]=this.cells[1]=this.cells[2]=this.cell;this.numChannels=1}l.extend(p);p.prototype.process=function(v){this.tickID!==v&&(this.tickID=v,this._.parent&&this._.parent.process(v));
return this};return p}(),H=function(){function p(v){D.call(this,2,v)}l.extend(p);p.prototype.process=function(v){var q=this._;this.tickID!==v&&(this.tickID=v,q.ar?(l.inputSignalAR(this),l.outputSignalAR(this)):(this.cells[0][0]=l.inputSignalKR(this),l.outputSignalKR(this)));return this};l.register("+",p);return p}(),L=function(){function p(v){D.call(this,1,[]);l.fixKR(this);this.value=v[0];if(w(v[1])){var q=v[1];this.once("init",function(){this.set(q)})}this.on("setAdd",l.changeWithValue);this.on("setMul",
l.changeWithValue)}l.extend(p);Object.defineProperties(p.prototype,{value:{set:function(v){"number"===typeof v&&(this._.value=isNaN(v)?0:v,l.changeWithValue.call(this))},get:function(){return this._.value}}});return p}(),K=function(){function p(v){D.call(this,1,[]);l.fixKR(this);this.value=v[0];if(w(v[1])){var q=v[1];this.once("init",function(){this.set(q)})}this.on("setAdd",l.changeWithValue);this.on("setMul",l.changeWithValue)}l.extend(p);Object.defineProperties(p.prototype,{value:{set:function(v){this._.value=
v?1:0;l.changeWithValue.call(this)},get:function(){return!!this._.value}}});return p}(),N=function(){function p(q){D.call(this,1,[]);l.fixKR(this);this.func=q[0];this._.value=0;if(w(q[1])){var x=q[1];this.once("init",function(){this.set(x)})}this.on("setAdd",l.changeWithValue);this.on("setMul",l.changeWithValue)}l.extend(p);var v=p.prototype;Object.defineProperties(v,{func:{set:function(q){"function"===typeof q&&(this._.func=q)},get:function(){return this._.func}},args:{set:function(q){r(q)?this._.args=
q:this._.args=[q]},get:function(){return this._.args}}});v.bang=function(){var q=this._,x=h.call(arguments).concat(q.args);x=q.func.apply(this,x);"number"===typeof x&&(q.value=x,l.changeWithValue.call(this));this._.emit("bang");return this};return p}(),Q=function(){function p(q){D.call(this,1,[]);var x;var y=0;for(x=q[0].length;y<x;++y)this.append(q[0][y]);if(w(q[1])){var A=q[1];this.once("init",function(){this.set(A)})}}l.extend(p);var v=p.prototype;v.bang=function(){var q=["bang"].concat(h.call(arguments)),
x=this.nodes,y;var A=0;for(y=x.length;A<y;++A)x[A].bang.apply(x[A],q);return this};v.postMessage=function(q){var x=this.nodes,y;var A=0;for(y=x.length;A<y;++A)x[A].postMessage(q);return this};v.process=function(q){var x=this._;this.tickID!==q&&(this.tickID=q,x.ar?(l.inputSignalAR(this),l.outputSignalAR(this)):(this.cells[0][0]=l.inputSignalKR(this),l.outputSignalKR(this)));return this};return p}(),R=function(){function p(v){D.call(this,1,[]);l.fixKR(this);if(w(v[1])){var q=v[1];this.once("init",function(){this.set(q)})}}
l.extend(p);return p}(),Y=function(){function p(y){D.call(this,2,[]);this.playbackState=0;var A=this._;A.node=y;A.onplay=v(this);A.onpause=q(this)}l.extend(p);var v=function(y){return function(){-1===e.inlets.indexOf(y)&&(e.inlets.push(y),e.events.emit("addObject"),y.playbackState=1,y._.emit("play"))}},q=function(y){return function(){var A=e.inlets.indexOf(y);-1!==A&&(e.inlets.splice(A,1),y.playbackState=0,y._.emit("pause"),e.events.emit("removeObject"))}},x=p.prototype;x.play=function(){e.nextTick(this._.onplay);
return-1===e.inlets.indexOf(this)};x.pause=function(){e.nextTick(this._.onpause)};x.process=function(y){var A=this._.node;A.playbackState&1?(A.process(y),this.cells[1].set(A.cells[1]),this.cells[2].set(A.cells[2])):(this.cells[1].set(l.emptycell),this.cells[2].set(l.emptycell))};return p}();z=function(){function p(){this.context=this;this.tickID=0;this.impl=null;this.amp=.8;this.status=0;this.samplerate=44100;this.channels=2;this.cellsize=64;this.streammsec=20;this.currentTime=this.streamsize=0;this.nextTicks=
[];this.inlets=[];this.timers=[];this.listeners=[];this.deferred=null;this.recStart=0;this.recBuffers=null;this.delayProcess=v(this);this.events=null;l.currentTimeIncr=1E3*this.cellsize/this.samplerate;l.emptycell=new l.SignalArray(this.cellsize);this.reset(!0)}var v=function(y){return function(){y.recStart=Date.now();y.process()}},q=p.prototype;q.bind=function(y,A){"function"===typeof y&&(this.impl=new y(this,A),this.impl.defaultSamplerate&&(this.samplerate=this.impl.defaultSamplerate));return this};
q.setup=function(y){"object"===typeof y&&(-1!==n.indexOf(y.samplerate)&&(this.samplerate=y.samplerate<=this.impl.maxSamplerate?y.samplerate:this.impl.maxSamplerate),-1!==g.indexOf(y.cellsize)&&(this.cellsize=y.cellsize),"undefined"!==typeof Float64Array&&"undefined"!==typeof y.f64&&(f=!!y.f64,l.SignalArray=f?Float64Array:Float32Array));l.currentTimeIncr=1E3*this.cellsize/this.samplerate;l.emptycell=new l.SignalArray(this.cellsize);return this};q.getAdjustSamples=function(y){y=y||this.samplerate;y=
Math.ceil(Math.log(this.streammsec/1E3*y)*Math.LOG2E);return 1<<(8>y?8:14<y?14:y)};q.play=function(){0===this.status&&(this.status=1,this.streamsize=this.getAdjustSamples(),this.strmL=new l.SignalArray(this.streamsize),this.strmR=new l.SignalArray(this.streamsize),this.impl.play(),this.events.emit("play"));return this};q.pause=function(){1===this.status&&(this.status=0,this.impl.pause(),this.events.emit("pause"));return this};q.reset=function(y){y&&(this.events=(new C(this)).on("addObject",function(){0===
this.status&&this.play()}).on("removeObject",function(){1===this.status&&0===this.inlets.length+this.timers.length+this.listeners.length&&this.pause()}));this.currentTime=0;this.nextTicks=[];this.inlets=[];this.timers=[];this.listeners=[];return this};q.process=function(){var y=this.tickID,A=this.strmL,B=this.strmR,I=this.amp,G,J=this.streamsize,M=0,S,P=this.cellsize,V=this.streamsize/this.cellsize,U=this.timers,O=this.inlets,X=this.listeners,ba=l.currentTimeIncr;for(G=0;G<J;++G)A[G]=B[G]=0;for(;V--;){++y;
var T=0;for(S=U.length;T<S;++T)U[T].playbackState&1&&U[T].process(y);T=0;for(S=O.length;T<S;++T){var aa=O[T];aa.process(y);if(aa.playbackState&1){var da=aa.cells[1];aa=aa.cells[2];var ca=0;for(G=M;ca<P;++ca,++G)A[G]+=da[ca],B[G]+=aa[ca]}}M+=P;T=0;for(S=X.length;T<S;++T)X[T].playbackState&1&&X[T].process(y);this.currentTime+=ba;G=this.nextTicks.splice(0);T=0;for(S=G.length;T<S;++T)G[T]()}for(G=0;G<J;++G)aa=A[G]*I,-1>aa?aa=-1:1<aa&&(aa=1),A[G]=aa,aa=B[G]*I,-1>aa?aa=-1:1<aa&&(aa=1),B[G]=aa;this.tickID=
y;y=this.currentTime;if(3===this.status){if(2===this.recCh)this.recBuffers.push(new l.SignalArray(A)),this.recBuffers.push(new l.SignalArray(B));else{I=new l.SignalArray(A.length);G=0;for(J=I.length;G<J;++G)I[G]=.5*(A[G]+B[G]);this.recBuffers.push(I)}y>=this.maxDuration?this.deferred.sub.reject():y>=this.recDuration?this.deferred.sub.resolve():20<Date.now()-this.recStart?setTimeout(this.delayProcess,10):this.process()}};q.nextTick=function(y){0===this.status?y():this.nextTicks.push(y)};q.rec=function(){l.fix_iOS6_1_problem(!0);
var y=new F(this);if(this.deferred)return console.warn("rec deferred is exists??"),y.reject().promise();if(0!==this.status)return console.log("status is not none",this.status),y.reject().promise();var A=0,B=arguments,I=w(B[A])?B[A++]:{};A=B[A];if("function"!==typeof A)return console.warn("no function"),y.reject().promise();this.deferred=y;this.status=3;this.reset();var G=new k("+"),J=new F(this),M=this;J.then(x,function(){l.fix_iOS6_1_problem(!1);x.call(M,!0)});this.deferred.sub=J;this.savedSamplerate=
this.samplerate;this.samplerate=I.samplerate||this.samplerate;this.recDuration=I.recDuration||Infinity;this.maxDuration=I.maxDuration||6E5;this.recCh=I.ch||1;2!==this.recCh&&(this.recCh=1);this.recBuffers=[];this.streamsize=this.getAdjustSamples();this.strmL=new l.SignalArray(this.streamsize);this.strmR=new l.SignalArray(this.streamsize);this.inlets.push(G);A({done:function(){J.resolve.apply(J,h.call(arguments))},send:function(){G.append.apply(G,arguments)}});setTimeout(this.delayProcess,10);return y.promise()};
var x=function(){this.status=0;this.reset();var y=this.recBuffers,A=this.samplerate,B=this.streamsize;this.samplerate=this.savedSamplerate;var I=Infinity!==this.recDuration?this.recDuration*A*.001|0:(y.length>>this.recCh-1)*B;var G,J=I/B|0,M=0,S=0,P=I;if(2===this.recCh){var V=new l.SignalArray(I),U=new l.SignalArray(I),O=new l.SignalArray(I);for(G=0;G<J;++G)if(V.set(y[M++],S),U.set(y[M++],S),S+=B,P-=B,0<P&&P<B){V.set(y[M++].subarray(0,P),S);U.set(y[M++].subarray(0,P),S);break}G=0;for(J=I;G<J;++G)O[G]=
.5*(V[G]+U[G]);y={samplerate:A,channels:2,buffer:[O,V,U]}}else{I=new l.SignalArray(I);for(G=0;G<J;++G)if(I.set(y[M++],S),S+=B,P-=B,0<P&&P<B){I.set(y[M++].subarray(0,P),S);break}y={samplerate:A,channels:1,buffer:[I]}}y=[].concat.apply([y],arguments);this.deferred.resolve.apply(this.deferred,y);this.deferred=null};q.on=function(y,A){this.events.on(y,A)};q.once=function(y,A){this.events.once(y,A)};q.off=function(y,A){this.events.off(y,A)};q.removeAllListeners=function(y){this.events.removeListeners(y)};
q.listeners=function(y){return this.events.listeners(y)};q.fix_iOS6_1_problem=function(y){this.impl.fix_iOS6_1_problem&&this.impl.fix_iOS6_1_problem(y)};return p}();var W=null,Z;"undefined"!==typeof window&&(Z=window.AudioContext||window.webkitAudioContext);W="undefined"!==typeof Z?function(p){var v=new Z,q,x;l._audioContext=v;this.defaultSamplerate=this.maxSamplerate=v.sampleRate;this.env="webkit";var y=navigator.userAgent;y.match(/linux/i)?p.streammsec*=8:y.match(/win(dows)?\s*(nt 5\.1|xp)/i)&&
(p.streammsec*=4);this.play=function(){var I=p.getAdjustSamples(v.sampleRate),G=p.streamsize;if(p.samplerate===v.sampleRate)var J=function(P){P=P.outputBuffer;p.process();P.getChannelData(0).set(p.strmL);P.getChannelData(1).set(p.strmR)};else if(2*p.samplerate===v.sampleRate)J=function(P){var V=p.strmL,U=p.strmR,O=P.outputBuffer;P=O.getChannelData(0);var X=O.getChannelData(1),ba=O.length,T;p.process();for(O=T=0;O<ba;O+=2,++T)P[O]=P[O+1]=V[T],X[O]=X[O+1]=U[T]};else{var M=G;var S=p.samplerate/v.sampleRate;
J=function(P){var V=p.strmL,U=p.strmR,O=P.outputBuffer;P=O.getChannelData(0);var X=O.getChannelData(1),ba=O.length;for(O=0;O<ba;++O)M>=G&&(p.process(),M-=G),P[O]=V[M|0],X[O]=U[M|0],M+=S}}q=v.createBufferSource();x=v.createScriptProcessor(I,2,p.channels);x.onaudioprocess=J;q.noteOn&&q.noteOn(0);q.connect(x);x.connect(v.destination)};this.pause=function(){q.disconnect();x.disconnect()};if(c){var A=0,B=v.createBufferSource();this.fix_iOS6_1_problem=function(I){A+=I?1:-1;1===A?(B.noteOn(0),B.connect(v.destination)):
0===A&&B.disconnect()}}}:function(p){this.maxSamplerate=48E3;this.defaultSamplerate=44100;this.env="nop";this.play=function(){};this.pause=function(){}};e=(new z).bind(W);"node"===b||"undefined"!==typeof module&&module.exports?module.exports=global.timbre=t:"browser"===b&&(t.noConflict=function(){var p=window.timbre,v=window.T;return function(q){window.T===t&&(window.T=v);q&&window.timbre===t&&(window.timbre=p);return t}}(),window.timbre=window.T=t);(function(){if("nop"===e.impl.env&&"browser"===
b&&!c){var p=navigator;try{var v=p.plugins&&p.mimeTypes&&p.mimeTypes.length?p.plugins["Shockwave Flash"].description.match(/([0-9]+)/)[0]:(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version").match(/([0-9]+)/)[0]}catch(A){v=-1}if(!(10>v)){var q,x=function(){var A=document.getElementsByTagName("script");if(A&&A.length)for(var B,I=0,G=A.length;I<G;++I)if(B=/^(.*\/)timbre(?:\.dev)?\.js$/i.exec(A[I].src))return B[1]+"timbre.swf"}();window.timbrejs_flashfallback_init=function(){e.bind(function(A){var B=
0;this.defaultSamplerate=this.maxSamplerate=44100;this.env="flash";this.play=function(){var I=Array(A.streamsize*A.channels),G=A.streammsec,J=0,M=A.streamsize/A.samplerate*1E3,S=Date.now();var P=function(){if(!(J>Date.now()-S)){var V=A.strmL,U=A.strmR,O=I.length,X=V.length;for(A.process();X--;)I[--O]=32768*U[X]|0,I[--O]=32768*V[X]|0;q.writeAudio(I.join(" "));J+=M}};q.setup?(q.setup(A.channels,A.samplerate),B=setInterval(P,G)):console.warn("Cannot find "+x)};this.pause=function(){0!==B&&(q.cancel(),
clearInterval(B),B=0)}});delete window.timbrejs_flashfallback_init};v=x+"?"+ +new Date;var y=document.createElement("div");y.id="TimbreFlashPlayerDiv";y.style.display="inline";y.width=y.height=1;p.plugins&&p.mimeTypes&&p.mimeTypes.length?(p=document.createElement("object"),p.id="TimbreFlashPlayer",p.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",p.width=p.height=1,p.setAttribute("data",v),p.setAttribute("type","application/x-shockwave-flash"),v=document.createElement("param"),v.setAttribute("name",
"allowScriptAccess"),v.setAttribute("value","always"),p.appendChild(v),y.appendChild(p)):y.innerHTML='<object id="TimbreFlashPlayer" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1" height="1"><param name="movie" value="'+v+'" /><param name="bgcolor" value="#FFFFFF" /><param name="quality" value="high" /><param name="allowScriptAccess" value="always" /></object>';window.addEventListener("load",function(){document.body.appendChild(y);q=document.TimbreFlashPlayer})}}})()})();
(function(u){function t(g){this.samplerate=g;this.frequency=340;this.Q=1;this.b0=this.b1=this.b2=this.a1=this.a2=this.x1R=this.x2R=this.y1R=this.y2R=this.x1L=this.x2L=this.y1L=this.y2L=this.gain=0;this.setType("lpf")}var h=t.prototype;h.process=function(g,e){var a=this.x1L,d=this.x2L,b=this.y1L,c=this.y2L,f=this.x1R,m=this.x2R,k=this.y1R,l=this.y2R,r=this.b0,w=this.b1,z=this.b2,C=this.a1,F=this.a2,D;var E=0;for(D=g.length;E<D;++E){var H=g[E];var L=r*H+w*a+z*d-C*b-F*c;d=a;a=H;c=b;b=L;H=e[E];var K=
r*H+w*f+z*m-C*k-F*l;m=f;f=H;l=k;k=K;g[E]=L;e[E]=K}this.x1L=a;this.x2L=d;this.y1L=b;this.y2L=c;this.x1R=f;this.x2R=m;this.y1R=k;this.y2R=l};h.setType=function(g){var e;if(e=n[g])this.type=g,e.call(this,this.frequency,this.Q,this.gain)};h.setParams=function(g,e,a){this.frequency=g;this.Q=e;this.gain=a;var d=n[this.type];d&&d.call(this,g,e,a);return this};var n={lowpass:function(g,e){g/=.5*this.samplerate;if(1<=g)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=g)this.b0=this.b1=this.b2=this.a1=
this.a2=0;else{e=Math.pow(10,.05*(0>e?0:e));g*=Math.PI;e=.5*Math.sqrt(.5*(4-Math.sqrt(16-16/(e*e))))*Math.sin(g);e=.5*(1-e)/(1+e);g=(.5+e)*Math.cos(g);var a=.25*(.5+e-g);this.b0=2*a;this.b1=4*a;this.b2=this.b0;this.a1=2*-g;this.a2=2*e}},highpass:function(g,e){g/=.5*this.samplerate;if(1<=g)this.b0=this.b1=this.b2=this.a1=this.a2=0;else if(0>=g)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{e=Math.pow(10,.05*(0>e?0:e));g*=Math.PI;e=.5*Math.sqrt((4-Math.sqrt(16-16/(e*e)))/2)*Math.sin(g);e=.5*(1-e)/
(1+e);g=(.5+e)*Math.cos(g);var a=.25*(.5+e+g);this.b0=2*a;this.b1=-4*a;this.b2=this.b0;this.a1=2*-g;this.a2=2*e}},bandpass:function(g,e){g/=.5*this.samplerate;if(0<g&&1>g)if(0<e){g*=Math.PI;e=Math.sin(g)/(2*e);g=Math.cos(g);var a=1/(1+e);this.b0=e*a;this.b1=0;this.b2=-e*a;this.a1=-2*g*a;this.a2=(1-e)*a}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=this.b1=this.b2=this.a1=this.a2=0},lowshelf:function(g,e,a){g/=.5*this.samplerate;e=Math.pow(10,a/40);if(1<=g)this.b0=e*e,this.b1=this.b2=
this.a1=this.a2=0;else if(0>=g)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{a=Math.PI*g;g=Math.cos(a);a=1*Math.sqrt(e)*Math.sin(a)*Math.sqrt(0*(e+1/e)+2);var d=e+1,b=e-1,c=1/(d+b*g+a);this.b0=e*(d-b*g+a)*c;this.b1=2*e*(b-d*g)*c;this.b2=e*(d-b*g-a)*c;this.a1=-2*(b+d*g)*c;this.a2=(d+b*g-a)*c}},highshelf:function(g,e,a){g/=.5*this.samplerate;e=Math.pow(10,a/40);if(1<=g)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=g)this.b0=e*e,this.b1=this.b2=this.a1=this.a2=0;else{a=Math.PI*g;g=Math.cos(a);
a=1*Math.sqrt(e)*Math.sin(a)*Math.sqrt(0*(e+1/e)+2);var d=e+1,b=e-1,c=1/(d-b*g+a);this.b0=e*(d+b*g+a)*c;this.b1=-2*e*(b+d*g)*c;this.b2=e*(d+b*g-a)*c;this.a1=2*(b-d*g)*c;this.a2=(d-b*g-a)*c}},peaking:function(g,e,a){g/=.5*this.samplerate;if(0<g&&1>g)if(a=Math.pow(10,a/40),0<e){g*=Math.PI;e=Math.sin(g)/(2*e);g=Math.cos(g);var d=1/(1+e/a);this.b0=(1+e*a)*d;this.b1=-2*g*d;this.b2=(1-e*a)*d;this.a1=this.b1;this.a2=(1-e/a)*d}else this.b0=a*a,this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=
this.a1=this.a2=0},notch:function(g,e){g/=.5*this.samplerate;if(0<g&&1>g)if(0<e){g*=Math.PI;e=Math.sin(g)/(2*e);g=Math.cos(g);var a=1/(1+e);this.b0=a;this.b1=-2*g*a;this.b2=a;this.a1=this.b1;this.a2=(1-e)*a}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},allpass:function(g,e){g/=.5*this.samplerate;if(0<g&&1>g)if(0<e){g*=Math.PI;e=Math.sin(g)/(2*e);g=Math.cos(g);var a=1/(1+e);this.b0=(1-e)*a;this.b1=-2*g*a;this.b2=(1+e)*a;this.a1=this.b1;this.a2=this.b0}else this.b0=
-1,this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0}};n.lpf=n.lowpass;n.hpf=n.highpass;n.bpf=n.bandpass;n.bef=n.notch;n.brf=n.notch;n.apf=n.allpass;u.modules.Biquad=t})(timbre);
(function(u){function t(g){this.samplerate=g;this.buffersize=1<<Math.round(Math.log(.1*g)*Math.LOG2E);this.bufferL=new u.fn.SignalArray(this.buffersize+1);this.bufferR=new u.fn.SignalArray(this.buffersize+1);this._wave=this.wave=null;this.writeIndex=this.buffersize>>1;this.readIndex=0;this.delayTime=20;this.rate=4;this.depth=20;this.feedback=.2;this.wet=.5;this.phaseIncr=this.phase=0;this.phaseStep=4;this.setWaveType("sin");this.setDelayTime(this.delayTime);this.setRate(this.rate)}var h=t.prototype,
n=[];n[0]=function(){for(var g=new Float32Array(512),e=0;512>e;++e)g[e]=Math.sin(e/512*Math.PI*2);return g}();n[1]=function(){for(var g=new Float32Array(512),e,a=0;512>a;++a)e=a/512-.25,g[a]=1-4*Math.abs(Math.round(e)-e);return g}();h.setWaveType=function(g){"sin"===g?(this.wave=g,this._wave=n[0]):"tri"===g&&(this.wave=g,this._wave=n[1])};h.setDelayTime=function(g){this.delayTime=g;for(g=this.writeIndex-(g*this.samplerate*.001|0);0>g;)g+=this.buffersize;this.readIndex=g};h.setRate=function(g){this.rate=
g;this.phaseIncr=512*this.rate/this.samplerate*this.phaseStep};h.process=function(g,e){var a=this.bufferL,d=this.bufferR,b=this.buffersize,c=b-1,f=this._wave,m=this.phase,k=this.phaseIncr,l=this.writeIndex,r=this.readIndex,w=this.depth,z=this.feedback,C=this.wet,F=1-C,D,E=g.length,H,L=this.phaseStep;for(D=0;D<E;){var K=f[m|0]*w;for(m+=k;512<m;)m-=512;for(H=0;H<L;++H,++D){var N=r+b+K&c;var Q=.5*(a[N]+a[N+1]);a[l]=g[D]-Q*z;g[D]=g[D]*F+Q*C;Q=.5*(d[N]+d[N+1]);d[l]=e[D]-Q*z;e[D]=e[D]*F+Q*C;l=l+1&c;r=r+
1&c}}this.phase=m;this.writeIndex=l;this.readIndex=r};u.modules.Chorus=t})(timbre);
(function(u){function t(n,g){this.samplerate=n;this.channels=g;this.preDelayReadIndex=this.lastPreDelayFrames=0;this.preDelayWriteIndex=256;this.K=this.ykneeThresholdDb=this.kneeThresholdDb=this.kneeThreshold=this.dbKnee=this.dbThreshold=this.linearThreshold=this.slope=this.ratio=-1;this.attackTime=.003;this.releaseTime=.25;this.preDelayTime=.006;this.dbPostGain=0;this.effectBlend=1;this.releaseZone1=.09;this.releaseZone2=.16;this.releaseZone3=.42;this.releaseZone4=.98;this.detectorAverage=0;this.meteringGain=
this.compressorGain=1;this.delayBufferL=new u.fn.SignalArray(1024);this.delayBufferR=2===g?new u.fn.SignalArray(1024):this.delayBufferL;this.preDelayTime=6;this.preDelayReadIndex=0;this.preDelayWriteIndex=256;this.maxAttackCompressionDiffDb=-1;this.meteringReleaseK=1-Math.exp(-1/(.325*this.samplerate));this.setAttackTime(this.attackTime);this.setReleaseTime(this.releaseTime);this.setPreDelayTime(this.preDelayTime);this.setParams(-24,30,12)}var h=t.prototype;h.clone=function(){var n=new t(this.samplerate,
this.channels);n.setAttackTime(this.attackTime);n.setReleaseTime(this.releaseTime);n.setPreDelayTime(this.preDelayTime);n.setParams(this.dbThreshold,this.dbKnee,this.ratio);return n};h.setAttackTime=function(n){this.attackTime=Math.max(.001,n);this._attackFrames=this.attackTime*this.samplerate};h.setReleaseTime=function(n){this.releaseTime=Math.max(.001,n);var g=this.releaseTime*this.samplerate;this._satReleaseFrames=.0025*this.samplerate;n=g*this.releaseZone1;var e=g*this.releaseZone2,a=g*this.releaseZone3;
g*=this.releaseZone4;this._kA=.9999999999999998*n+1.8432219684323923E-16*e-1.9373394351676423E-16*a+8.824516011816245E-18*g;this._kB=-1.5788320352845888*n+2.3305837032074286*e-.9141194204840429*a+.1623677525612032*g;this._kC=.5334142869106424*n-1.272736789213631*e+.9258856042207512*a-.18656310191776226*g;this._kD=.08783463138207234*n-.1694162967925622*e+.08588057951595272*a-.00429891410546283*g;this._kE=-.042416883008123074*n+.1115693827987602*e-.09764676325265872*a+.028494263462021576*g};h.setPreDelayTime=
function(n){this.preDelayTime=n;n*=this.samplerate;1023<n&&(n=1023);if(this.lastPreDelayFrames!==n){this.lastPreDelayFrames=n;for(var g=0,e=this.delayBufferL.length;g<e;++g)this.delayBufferL[g]=this.delayBufferR[g]=0;this.preDelayReadIndex=0;this.preDelayWriteIndex=n}};h.setParams=function(n,g,e){this._k=this.updateStaticCurveParameters(n,g,e);n=this.saturate(1,this._k);this._masterLinearGain=Math.pow(10,.05*this.dbPostGain)*Math.pow(1/n,.6)};h.kneeCurve=function(n,g){return n<this.linearThreshold?
n:this.linearThreshold+(1-Math.exp(-g*(n-this.linearThreshold)))/g};h.saturate=function(n,g){return n<this.kneeThreshold?this.kneeCurve(n,g):Math.pow(10,.05*(this.ykneeThresholdDb+this.slope*((n?20*Math.log(n)*Math.LOG10E:-1E3)-this.kneeThresholdDb)))};h.slopeAt=function(n,g){if(n<this.linearThreshold)return 1;var e=1.001*n,a=n?20*Math.log(n)*Math.LOG10E:-1E3,d=e?20*Math.log(e)*Math.LOG10E:-1E3;n=this.kneeCurve(n,g);g=this.kneeCurve(e,g);return((g?20*Math.log(g)*Math.LOG10E:-1E3)-(n?20*Math.log(n)*
Math.LOG10E:-1E3))/(d-a)};h.kAtSlope=function(n){for(var g=Math.pow(10,.05*(this.dbThreshold+this.dbKnee)),e=.1,a=1E4,d=5,b=0;15>b;++b)this.slopeAt(g,d)<n?a=d:e=d,d=Math.sqrt(e*a);return d};h.updateStaticCurveParameters=function(n,g,e){this.dbThreshold=n;this.linearThreshold=Math.pow(10,.05*n);this.dbKnee=g;this.ratio=e;this.slope=1/this.ratio;this.kneeThresholdDb=n+g;this.kneeThreshold=Math.pow(10,.05*this.kneeThresholdDb);n=this.kAtSlope(1/this.ratio);this.ykneeThresholdDb=(g=this.kneeCurve(this.kneeThreshold,
n))?20*Math.log(g)*Math.LOG10E:-1E3;return this._k=n};h.process=function(n,g){for(var e=1-this.effectBlend,a=this.effectBlend,d=this._k,b=this._masterLinearGain,c=this._satReleaseFrames,f=this._kA,m=this._kB,k=this._kC,l=this._kD,r=this._kE,w=n.length/64,z=0,C=this.detectorAverage,F=this.compressorGain,D=this.maxAttackCompressionDiffDb,E=1/this._attackFrames,H=this.preDelayReadIndex,L=this.preDelayWriteIndex,K=this.detectorAverage,N=this.delayBufferL,Q=this.delayBufferR,R=this.meteringGain,Y=this.meteringReleaseK,
W=0;W<w;++W){var Z=Math.asin(C)/(.5*Math.PI);var p=Z>F;var v=F/Z;v=v?20*Math.log(v)*Math.LOG10E:-1E3;if(Infinity===v||isNaN(v))v=-1;if(p)D=-1,v=-12>v?0:0<v?3:.25*(v+12),p=v*v,p=Math.pow(10,5/(f+m*v+k*p+l*p*v+r*p*p)*.05);else{if(-1===D||D<v)D=v;v=.25/Math.max(.5,D);p=1-Math.pow(v,E)}for(v=64;v--;){var q=0,x=.5*(n[z]+g[z]);N[L]=n[z];Q[L]=g[z];0>x&&(x*=-1);q<x&&(q=x);0>q&&(q*=-1);x=this.saturate(q,d);x=(q=1E-4>=q?1:x/q)?-20*Math.log(q)*Math.LOG10E:1E3;2>x&&(x=2);x=Math.pow(10,x/c*.05)-1;K+=(q-K)*(q>
K?x:1);1<K&&(K=1);1>p?F+=(Z-F)*p:(F*=p,1<F&&(F=1));x=Math.sin(.5*Math.PI*F);q=e+a*b*x;x=20*Math.log(x)*Math.LOG10E;R=x<R?x:R+(x-R)*Y;n[z]=N[H]*q;g[z]=Q[H]*q;z++;H=H+1&1023;L=L+1&1023}1E-6>K&&(K=1E-6);1E-6>F&&(F=1E-6)}this.preDelayReadIndex=H;this.preDelayWriteIndex=L;this.detectorAverage=K;this.compressorGain=F;this.maxAttackCompressionDiffDb=D;this.meteringGain=R};h.reset=function(){this.detectorAverage=0;this.meteringGain=this.compressorGain=1;for(var n=0,g=this.delayBufferL.length;n<g;++n)this.delayBufferL[n]=
this.delayBufferR[n]=0;this.preDelayReadIndex=0;this.preDelayWriteIndex=256;this.maxAttackCompressionDiffDb=-1};u.modules.Compressor=t})(timbre);
(function(u){function t(){}t.prototype.decode=function(h,n,g){if("string"===typeof h){if(/\.wav$/.test(h))return t.wav_decode(h,n,g);if(t.ogg_decode&&/\.ogg$/.test(h))return t.ogg_decode(h,n,g);if(t.mp3_decode&&/\.mp3$/.test(h))return t.mp3_decode(h,n,g)}else if("object"===typeof h){if("wav"===h.type)return t.wav_decode(h.data,n,g);if(t.ogg_decode&&"ogg"===h.type)return t.ogg_decode(h.data,n,g);if(t.mp3_decode&&"mp3"===h.type)return t.mp3_decode(h.data,n,g)}if(t.webkit_decode)return"object"===typeof h?
t.webkit_decode(h.data||h,n,g):t.webkit_decode(h,n,g);if(t.moz_decode)return t.moz_decode(h,n,g);n(!1)};u.modules.Decoder=t;t.getBinaryWithPath="browser"===u.envtype?function(h,n){u.fn.fix_iOS6_1_problem(!0);var g=new XMLHttpRequest;g.open("GET",h);g.responseType="arraybuffer";g.onreadystatechange=function(){4===g.readyState&&(g.response?n(new Uint8Array(g.response)):void 0!==g.responseBody&&n(new Uint8Array(VBArray(g.responseBody).toArray())),u.fn.fix_iOS6_1_problem(!1))};g.send()}:function(h,n){n("no support")};
t.wav_decode=function(){var h=function(n,g,e){if("RIFF"!==String.fromCharCode(n[0],n[1],n[2],n[3])||n[4]+(n[5]<<8)+(n[6]<<16)+(n[7]<<24)+8!==n.length||"WAVE"!==String.fromCharCode(n[8],n[9],n[10],n[11])||"fmt "!==String.fromCharCode(n[12],n[13],n[14],n[15]))return g(!1);for(var a=n[22]+(n[23]<<8),d=n[24]+(n[25]<<8)+(n[26]<<16)+(n[27]<<24),b=n[34]+(n[35]<<8),c=36;c<n.length&&"data"!==String.fromCharCode(n[c],n[c+1],n[c+2],n[c+3]);)c+=1;if(c>=n.length)return g(!1);c+=4;var f=n[c]+(n[c+1]<<8)+(n[c+2]<<
16)+(n[c+3]<<24),m=(f/a>>1)/d;c+=4;if(f>n.length-c)return g(!1);f=new Float32Array(m*d|0);if(2===a){var k=new Float32Array(f.length);var l=new Float32Array(f.length)}g({samplerate:d,channels:a,buffer:[f,k,l],duration:m});if(8===b)n=new Int8Array(n.buffer,c);else if(16===b)n=new Int16Array(n.buffer,c);else if(32===b)n=new Int32Array(n.buffer,c);else if(24===b){n=new Uint8Array(n.buffer,c);c=new Int32Array(n.length/3);g=0;d=n.length;for(m=0;g<d;){var r=n[g++];var w=n[g++];var z=n[g++];r=r+(w<<8)+(z<<
16);r=r&8388608?r-16777216:r;c[m++]=r}n=c}b=1/((1<<b-1)-1);if(2===a)for(c=g=0,a=f.length;c<a;++c)d=k[c]=n[g++]*b,d+=l[c]=n[g++]*b,f[c]=.5*d;else for(c=0,a=f.length;c<a;++c)f[c]=n[c]*b;e()};return function(n,g,e){"string"===typeof n?t.getBinaryWithPath(n,function(a){h(a,g,e)}):h(n,g,e)}}();t.webkit_decode=function(){if("undefined"!==typeof u.fn._audioContext){var h=u.fn._audioContext,n=function(g,e,a){if("string"===typeof g)return a(!1);try{var d=h.createBuffer(g.buffer,!1)}catch(r){return e(!1)}g=
h.sampleRate;var b=d.numberOfChannels;if(2===b){var c=d.getChannelData(0);d=d.getChannelData(1)}else c=d=d.getChannelData(0);var f=c.length/g;for(var m=new Float32Array(c),k=0,l=m.length;k<l;++k)m[k]=.5*(m[k]+d[k]);e({samplerate:g,channels:b,buffer:[m,c,d],duration:f});a()};return function(g,e,a){if(g instanceof File){var d=new FileReader;d.onload=function(b){n(new Uint8Array(b.target.result),e,a)};d.readAsArrayBuffer(g)}else"string"===typeof g?t.getBinaryWithPath(g,function(b){n(b,e,a)}):n(g,e,a)}}}();
t.moz_decode=function(){if("function"===typeof Audio&&"function"===typeof(new Audio).mozSetup)return function(h,n,g){var e,a,d,b,c,f,m=0,k=new Audio(h);k.volume=0;k.addEventListener("loadedmetadata",function(){e=k.mozSampleRate;a=k.mozChannels;f=k.duration;d=new Float32Array(k.duration*e|0);2===a&&(b=new Float32Array(k.duration*e|0),c=new Float32Array(k.duration*e|0));2===a?k.addEventListener("MozAudioAvailable",function(l){for(var r=l.frameBuffer,w=0,z=r.length;w<z;w+=2)l=b[m]=r[w],l+=c[m]=r[w+1],
d[m]=.5*l,m+=1},!1):k.addEventListener("MozAudioAvailable",function(l){l=l.frameBuffer;for(var r=0,w=l.length;r<w;++r)d[r]=l[r],m+=1},!1);k.play();setTimeout(function(){n({samplerate:e,channels:a,buffer:[d,b,c],duration:f})},1E3)},!1);k.addEventListener("ended",function(){g()},!1);k.load()}}()})(timbre);
(function(u){function t(E){this.samplerate=E||44100;this.value=n;this.status=k;this.curve="linear";this.step=1;this.emit=this.loopNode=this.releaseNode=null;this._envValue=new h(E);this._table=[];this._initValue=n;this._curveValue=0;this._defaultCurveType=e;this._counter=this._index=0}function h(E){this.samplerate=E;this.value=n;this.step=1;this._curveType=e;this._y2=this._y1=this._b1=this._a2=this._grow=this._curveValue=0}var n=t.ZERO=1E-6,g=t.CurveTypeSet=0,e=t.CurveTypeLin=1,a=t.CurveTypeExp=2,
d=t.CurveTypeSin=3,b=t.CurveTypeWel=4,c=t.CurveTypeCurve=5,f=t.CurveTypeSqr=6,m=t.CurveTypeCub=7,k=t.StatusWait=0,l=t.StatusGate=1,r=t.StatusSustain=2,w=t.StatusRelease=3,z=t.StatusEnd=4,C={set:g,lin:e,linear:e,exp:a,exponential:a,sin:d,sine:d,wel:b,welch:b,sqr:f,squared:f,cub:m,cubed:m};t.CurveTypeDict=C;var F=t.prototype;F.clone=function(){var E=new t(this.samplerate);E._table=this._table;E._initValue=this._initValue;E.setCurve(this.curve);null!==this.releaseNode&&E.setReleaseNode(this.releaseNode+
1);null!==this.loopNode&&E.setLoopNode(this.loopNode+1);E.setStep(this.step);E.reset();return E};F.setTable=function(E){this._initValue=E[0];this._table=E.slice(1);this.value=this._envValue.value=this._initValue;this._counter=this._index=0;this.status=k};F.setCurve=function(E){"number"===typeof E?(this._defaultCurveType=c,this._curveValue=E):this._defaultCurveType=C[E]||null;this.curve=E};F.setReleaseNode=function(E){"number"===typeof E&&0<E&&(this.releaseNode=E-1)};F.setLoopNode=function(E){"number"===
typeof E&&0<E&&(this.loopNode=E-1)};F.setStep=function(E){this.step=this._envValue.step=E};F.reset=function(){this.value=this._envValue.value=this._initValue;this._counter=this._index=0;this.status=k};F.release=function(){null!==this.releaseNode&&this._index<=this.releaseNode&&(this._counter=0,this._index=this.releaseNode,this.status=w)};F.getInfo=function(E){var H=this._table,L,K=0,N=Infinity,Q=Infinity,R=!1;var Y=0;for(L=H.length;Y<L;++Y){this.loopNode===Y&&(N=K);this.releaseNode===Y&&(Q=K=K<E?
K+E:E);var W=H[Y];Array.isArray(W)&&(K+=W[1])}Infinity!==N&&Infinity===Q&&(K+=E,R=!0);return{totalDuration:K,loopBeginTime:N,releaseBeginTime:Q,isEndlessLoop:R}};F.calcStatus=function(){var E=this.status,H=this._table,L=this._index,K=this._counter,N=this._curveValue,Q=this._defaultCurveType,R=this.loopNode,Y=this.releaseNode,W=this._envValue,Z=null;switch(E){case l:case w:for(;0>=K;)if(L>=H.length)E===l&&null!==R?L=R:(E=z,K=Infinity,Z="ended");else if(E===l&&L===Y)null!==R&&R<Y?L=R:(E=r,K=Infinity,
Z="sustained");else{var p=H[L++];K=p[0];var v=null===p[2]?Q:p[2];v===c&&(N=p[3],.001>Math.abs(N)&&(v=e));p=p[1];K=W.setNext(K,p,v,N)}}this.status=E;this.emit=Z;this._index=L;this._counter=K;return E};F.next=function(){this.calcStatus()&1&&(this.value=this._envValue.next()||n);--this._counter;return this.value};F.process=function(E){var H=this._envValue,L,K=E.length;if(this.calcStatus()&1)for(L=0;L<K;++L)E[L]=H.next()||n;else for(H=this.value||n,L=0;L<K;++L)E[L]=H;this.value=E[K-1];this._counter-=
E.length};h.prototype.setNext=function(E,H,L,K){var N=this.value;H=.001*H*this.samplerate/this.step|0;1>H&&(H=1,L=g);switch(L){case g:this.value=E;break;case e:var Q=(E-N)/H;break;case a:Q=0!==N?Math.pow(E/N,1/H):0;break;case d:K=Math.PI/H;var R=.5*(E+N);var Y=2*Math.cos(K);var W=.5*(E-N);var Z=W*Math.sin(.5*Math.PI-K);break;case b:K=.5*Math.PI/H;Y=2*Math.cos(K);E>=N?(R=N,W=0,Z=-Math.sin(K)*(E-N)):(R=E,W=N-E,Z=Math.cos(K)*(N-E));break;case c:E=(E-N)/(1-Math.exp(K));R=N+E;Y=E;Q=Math.exp(K/H);break;
case f:W=Math.sqrt(N);Z=Math.sqrt(E);Q=(Z-W)/H;break;case m:W=Math.pow(N,.33333333),Z=Math.pow(E,.33333333),Q=(Z-W)/H}this.next=D[L];this._grow=Q;this._a2=R;this._b1=Y;this._y1=W;this._y2=Z;return H};var D=[];D[g]=function(){return this.value};D[e]=function(){return this.value+=this._grow};D[a]=function(){return this.value*=this._grow};D[d]=function(){var E=this._b1*this._y1-this._y2;this.value=this._a2-E;this._y2=this._y1;this._y1=E;return this.value};D[b]=function(){var E=this._b1*this._y1-this._y2;
this.value=this._a2+E;this._y2=this._y1;this._y1=E;return this.value};D[c]=function(){this._b1*=this._grow;return this.value=this._a2-this._b1};D[f]=function(){this._y1+=this._grow;return this.value=this._y1*this._y1};D[m]=function(){this._y1+=this._grow;return this.value=this._y1*this._y1*this._y1};h.prototype.next=D[g];u.modules.Envelope=t;u.modules.EnvelopeValue=h})(timbre);
(function(u){function t(e){this.length=e=1<<Math.ceil(Math.log("number"===typeof e?e:512)*Math.LOG2E);this.buffer=new u.fn.SignalArray(e);this.real=new u.fn.SignalArray(e);this.imag=new u.fn.SignalArray(e);this._real=new u.fn.SignalArray(e);this._imag=new u.fn.SignalArray(e);this.mag=new u.fn.SignalArray(e>>1);this.minDecibels=-30;this.maxDecibels=-100;e=n.get(e);this._bitrev=e.bitrev;this._sintable=e.sintable;this._costable=e.costable}var h=t.prototype;h.setWindow=function(e){if("string"===typeof e){var a=
/([A-Za-z]+)(?:\(([01]\.?\d*)\))?/.exec(e);if(null!==a){var d=a[1].toLowerCase();a=void 0!==a[2]?+a[2]:.25;if(d=g[d]){this._window||(this._window=new u.fn.SignalArray(this.length));var b=this._window,c=0,f=this.length;for(a=0>a?0:1<a?1:a;c<f;++c)b[c]=d(c,f,a);this.windowName=e}}}};h.forward=function(e){var a=this.buffer,d=this.real,b=this.imag,c=this._window,f=this._bitrev,m=this._sintable,k=this._costable,l=a.length,r;if(c)for(r=0;r<l;++r)a[r]=e[r]*c[r];else a.set(e);for(r=0;r<l;++r)d[r]=a[f[r]],
b[r]=0;for(a=1;a<l;a=c){f=0;c=a+a;var w=l/c;for(e=0;e<a;e++){var z=k[f];var C=m[f];for(r=e;r<l;r+=c){var F=r+a;var D=C*b[F]+z*d[F];var E=z*b[F]-C*d[F];d[F]=d[r]-D;d[r]+=D;b[F]=b[r]-E;b[r]+=E}f+=w}}m=this.mag;for(r=0;r<l;++r)k=d[r],e=b[r],m[r]=Math.sqrt(k*k+e*e);return{real:d,imag:b}};h.inverse=function(e,a){var d=this.buffer,b=this._real,c=this._imag,f=this._bitrev,m=this._sintable,k=this._costable,l=d.length,r;for(r=0;r<l;++r){var w=f[r];b[r]=+e[w];c[r]=-a[w]}for(e=1;e<l;e=a){f=0;a=e+e;var z=l/a;
for(w=0;w<e;w++){var C=k[f];var F=m[f];for(r=w;r<l;r+=a){var D=r+e;var E=F*c[D]+C*b[D];var H=C*c[D]-F*b[D];b[D]=b[r]-E;b[r]+=E;c[D]=c[r]-H;c[r]+=H}f+=z}}for(r=0;r<l;++r)d[r]=b[r]/l;return d};h.getFrequencyData=function(e){var a=this.minDecibels,d,b=Math.min(this.mag.length,e.length);if(b){var c=this.mag,f=0;for(d=0;d<b;++d){var m=c[d];e[d]=m?20*Math.log(m)*Math.LOG10E:a;f<e[d]&&(f=e[d])}}return e};var n={get:function(e){var a;if(!(a=n[e])){var d,b,c;a=new Int16Array(e);var f=e>>1;for(d=b=0;;){a[d]=
b;if(++d>=e)break;for(c=f;c<=b;)b-=c,c>>=1;b+=c}b=Math.floor(Math.log(e)/Math.LN2);d=new u.fn.SignalArray((1<<b)-1);f=new u.fn.SignalArray((1<<b)-1);var m=2*Math.PI;b=0;for(c=d.length;b<c;++b)d[b]=Math.sin(b/e*m),f[b]=Math.cos(b/e*m);n[e]={bitrev:a,sintable:d,costable:f};a=n[e]}return a}},g=function(){var e=Math.PI,a=2*Math.PI,d=Math.abs,b=Math.pow,c=Math.cos,f=Math.sin,m=Math.E;return{rectangular:function(){return 1},hann:function(k,l){return.5*(1-c(a*k/(l-1)))},hamming:function(k,l){return.54-.46*
c(a*k/(l-1))},tukery:function(k,l,r){return k<r*(l-1)/2?.5*(1+c(e*(2*k/(r*(l-1))-1))):(l-1)*(1-r/2)<k?.5*(1+c(e*(2*k/(r*(l-1))-2/r+1))):1},cosine:function(k,l){return f(e*k/(l-1))},lanczos:function(k,l){k=2*k/(l-1)-1;return f(e*k)/(e*k)},triangular:function(k,l){return 2/(l+1)*((l+1)/2-d(k-(l-1)/2))},bartlett:function(k,l){return 2/(l-1)*((l-1)/2-d(k-(l-1)/2))},gaussian:function(k,l,r){return b(m,-.5*b((k-(l-1)/2)/(r*(l-1)/2),2))},bartlettHann:function(k,l){return.62-.48*d(k/(l-1)-.5)-.38*c(a*k/(l-
1))},blackman:function(k,l,r){var w=r/2;return(1-r)/2-.5*c(a*k/(l-1))+w*c(4*e*k/(l-1))}}}();u.modules.FFT=t})(timbre);
(function(u){function t(d){this.samplerate=d||44100;this.wave=null;this.step=1;this.phase=this.value=this.frequency=0;this.feedback=!1;this._lastouts=this._x=0;this._coeff=h/this.samplerate;this._radtoinc=h/(2*Math.PI)}var h=1024,n=h-1,g=t.prototype;g.setWave=function(d){var b,c=this.wave;this.wave||(this.wave=new Float32Array(h+1));if("function"===typeof d)for(b=0;b<h;++b)c[b]=d(b/h);else if(u.fn.isSignalArray(d))if(d.length===c.length)c.set(d);else{var f=d.length/h;for(b=0;b<h;++b)c[b]=d[b*f|0]}else"string"===
typeof d&&void 0!==(f=e(d))&&this.wave.set(f);this.wave[h]=this.wave[0]};g.clone=function(){var d=new t(this.samplerate);d.wave=this.wave;d.step=this.step;d.frequency=this.frequency;d.value=this.value;d.phase=this.phase;d.feedback=this.feedback;return d};g.reset=function(){this._x=0};g.next=function(){var d=this._x;this.value=this.wave[(d+this.phase*this._radtoinc|0)&n];d+=this.frequency*this._coeff*this.step;d>h&&(d-=h);this._x=d;return this.value};g.process=function(d){var b=this.wave,c=this._radtoinc,
f=this._x,m=this.frequency*this._coeff,k,l=this.step;if(this.feedback){var r=this._lastouts;c*=this.phase;for(k=0;k<l;++k){var w=f+r*c;r=w|0;w-=r;r&=n;var z=b[r];r=b[r+1];d[k]=r=z+w*(r-z);f+=m}this._lastouts=r}else for(c*=this.phase,k=0;k<l;++k)w=f+c,r=w|0,w-=r,r&=n,z=b[r],r=b[r+1],d[k]=z+w*(r-z),f+=m;f>h&&(f-=h);this._x=f;this.value=d[d.length-1]};g.processWithFreqArray=function(d,b){var c=this.wave,f=this._radtoinc,m=this._x,k=this._coeff,l,r=this.step;if(this.feedback){var w=this._lastouts;f*=
this.phase;for(l=0;l<r;++l){var z=m+w*f;w=z|0;z-=w;w&=n;var C=c[w];w=c[w+1];d[l]=w=C+z*(w-C);m+=b[l]*k}this._lastouts=w}else for(f=this.phase*this._radtoinc,l=0;l<r;++l)z=m+f,w=z|0,z-=w,w&=n,C=c[w],w=c[w+1],d[l]=C+z*(w-C),m+=b[l]*k;m>h&&(m-=h);this._x=m;this.value=d[d.length-1]};g.processWithPhaseArray=function(d,b){var c=this.wave,f=this._radtoinc,m=this._x,k=this.frequency*this._coeff,l,r=this.step;if(this.feedback){b=this._lastouts;f*=this.phase;for(l=0;l<r;++l){var w=m+b*f;var z=w|0;w-=z;z&=n;
var C=c[z];z=c[z+1];d[l]=b=C+w*(z-C);m+=k}this._lastouts=b}else for(l=0;l<r;++l)w=m+b[l]*f,z=w|0,w-=z,z&=n,C=c[z],z=c[z+1],d[l]=C+w*(z-C),m+=k;m>h&&(m-=h);this._x=m;this.value=d[d.length-1]};g.processWithFreqAndPhaseArray=function(d,b,c){var f=this.wave,m=this._radtoinc,k=this._x,l=this._coeff,r,w=this.step;if(this.feedback){c=this._lastouts;m*=this.phase;for(r=0;r<w;++r){var z=k+c*m;var C=z|0;z-=C;C&=n;var F=f[C];C=f[C+1];d[r]=c=F+z*(C-F);k+=b[r]*l}this._lastouts=c}else for(r=0;r<w;++r)z=k+c[r]*
h,C=z|0,z-=C,C&=n,F=f[C],C=f[C+1],d[r]=F+z*(C-F),k+=b[r]*l;k>h&&(k-=h);this._x=k;this.value=d[d.length-1]};var e=function(d){var b=a[d];if(void 0!==b)return"function"===typeof b&&(b=b()),b;var c=/^([\-+]?)(\w+)(?:\((@[0-7])?:?(\d+)?\))?$/.exec(d);if(null!==c){b=c[1];var f=c[3],m=c[4];c=a[c[2]];var k;if(void 0===c)b=void 0;else{"function"===typeof c&&(c=c());switch(f){case "@1":for(k=512;1024>k;++k)c[k]=0;break;case "@2":for(k=512;1024>k;++k)c[k]=Math.abs(c[k]);break;case "@3":for(k=256;512>k;++k)c[k]=
0;for(k=512;768>k;++k)c[k]=Math.abs(c[k]);for(k=768;1024>k;++k)c[k]=0;break;case "@4":f=new Float32Array(1024);for(k=0;512>k;++k)f[k]=c[k<<1];c=f;break;case "@5":f=new Float32Array(1024);for(k=0;512>k;++k)f[k]=Math.abs(c[k<<1]);c=f}if(void 0!==m&&50!==m){m*=.01;m=0>m?0:1<m?1:m;f=new Float32Array(1024);m=1024*m|0;for(k=0;k<m;++k)f[k]=c[k/m*512|0];var l=1024-m;for(m=0;1024>k;++k,++m)f[k]=c[m/l*512+512|0];c=f}if("+"===b)for(k=0;1024>k;++k)c[k]=.5*c[k]+.5;else if("-"===b)for(k=0;1024>k;++k)c[k]*=-1;b=
c}if(void 0!==b)return a[d]=b}c=/^wavb\(((?:[0-9a-fA-F][0-9a-fA-F])+)\)$/.exec(d);if(null!==c){var r=c[1];d=new Float32Array(1024);b=r.length>>1;if(-1!==[2,4,8,16,32,64,128,256,512,1024].indexOf(b))for(f=c=0;c<b;++c)for(k=parseInt(r.substr(2*c,2),16),k=k&128?(k-256)/128:k/127,m=0,l=1024/b;m<l;++m)d[f++]=k;return d}c=/^wavc\(([0-9a-fA-F]{8})\)$/.exec(d);if(null!==c){b=c[1];d=new Float32Array(1024);if(8===b.length){f=parseInt(b,16);c=new Float32Array(8);c[0]=1;for(b=0;7>b;++b)c[b+1]=.0625*(f&15),f>>=
4;for(b=0;8>b;++b)for(k=0,m=(b+1)/1024,f=0;1024>f;++f)d[f]+=Math.sin(2*Math.PI*k)*c[b],k+=m;for(b=c=0;1024>b;++b)c<(r=Math.abs(d[b]))&&(c=r);if(0<c)for(b=0;1024>b;++b)d[b]/=c}return d}};t.getWavetable=e;t.setWavetable=function(d,b){var c=new Float32Array(1024),f;if("function"===typeof b)for(f=0;1024>f;++f)c[f]=b(f/1024);else if(u.fn.isSignalArray(b))if(b.length===c.length)c.set(b);else{var m=b.length/1024;for(f=0;1024>f;++f)c[f]=b[f*m|0]}a[d]=c};var a={sin:function(){for(var d=new Float32Array(1024),
b=0;1024>b;++b)d[b]=Math.sin(b/1024*Math.PI*2);return d},cos:function(){for(var d=new Float32Array(1024),b=0;1024>b;++b)d[b]=Math.cos(b/1024*Math.PI*2);return d},pulse:function(){for(var d=new Float32Array(1024),b=0;1024>b;++b)d[b]=512>b?1:-1;return d},tri:function(){for(var d=new Float32Array(1024),b,c=0;1024>c;++c)b=c/1024-.25,d[c]=1-4*Math.abs(Math.round(b)-b);return d},saw:function(){for(var d=new Float32Array(1024),b,c=0;1024>c;++c)b=c/1024,d[c]=2*(b-Math.round(b));return d},fami:function(){for(var d=
[0,.125,.25,.375,.5,.625,.75,.875,.875,.75,.625,.5,.375,.25,.125,0,-.125,-.25,-.375,-.5,-.625,-.75,-.875,-1,-1,-.875,-.75,-.625,-.5,-.375,-.25,-.125],b=new Float32Array(1024),c=0;1024>c;++c)b[c]=d[c/1024*d.length|0];return b},konami:function(){for(var d=[-.625,-.875,-.125,.75,.5,.125,.5,.75,.25,-.125,.5,.875,.625,0,.25,.375,-.125,-.75,0,.625,.125,-.5,-.375,-.125,-.75,-1,-.625,0,-.375,-.875,-.625,-.25],b=new Float32Array(1024),c=0;1024>c;++c)b[c]=d[c/1024*d.length|0];return b}};u.modules.Oscillator=
t})(timbre);
(function(u){function t(d,b){this.samplerate=d;var c=d/44100;var f=2*g.length;this.comb=Array(f);this.combout=Array(f);for(d=0;d<f;++d)this.comb[d]=new h(g[d%g.length]*c),this.combout[d]=new u.fn.SignalArray(b);f=2*e.length;this.allpass=Array(f);for(d=0;d<f;++d)this.allpass[d]=new n(e[d%e.length]*c);this.outputs=[new u.fn.SignalArray(b),new u.fn.SignalArray(b)];this.damp=0;this.wet=.33;this.setRoomSize(.5);this.setDamp(.5)}function h(d){this.buffer=new u.fn.SignalArray(d|0);this.buffersize=this.buffer.length;
this.damp=this.filterstore=this.feedback=this.bufidx=0}function n(d){this.buffer=new u.fn.SignalArray(d|0);this.buffersize=this.buffer.length;this.bufidx=0}var g=[1116,1188,1277,1356,1422,1491,1557,1617],e=[225,556,441,341],a=t.prototype;a.setRoomSize=function(d){var b=this.comb;this.roomsize=d;b[0].feedback=b[1].feedback=b[2].feedback=b[3].feedback=b[4].feedback=b[5].feedback=b[6].feedback=b[7].feedback=b[8].feedback=b[9].feedback=b[10].feedback=b[11].feedback=b[12].feedback=b[13].feedback=b[14].feedback=
b[15].feedback=.28*d+.7};a.setDamp=function(d){var b=this.comb;this.damp=d;b[0].damp=b[1].damp=b[2].damp=b[3].damp=b[4].damp=b[5].damp=b[6].damp=b[7].damp=b[8].damp=b[9].damp=b[10].damp=b[11].damp=b[12].damp=b[13].damp=b[14].damp=b[15].damp=.4*d};a.process=function(d,b){var c=this.comb,f=this.combout,m=this.allpass,k=this.outputs[0],l=this.outputs[1],r=this.wet,w=1-r,z=d.length;c[0].process(d,f[0]);c[1].process(d,f[1]);c[2].process(d,f[2]);c[3].process(d,f[3]);c[4].process(d,f[4]);c[5].process(d,
f[5]);c[6].process(d,f[6]);c[7].process(d,f[7]);c[8].process(b,f[8]);c[9].process(b,f[9]);c[10].process(b,f[10]);c[11].process(b,f[11]);c[12].process(b,f[12]);c[13].process(b,f[13]);c[14].process(b,f[14]);c[15].process(b,f[15]);for(c=0;c<z;++c)k[c]=f[0][c]+f[1][c]+f[2][c]+f[3][c]+f[4][c]+f[5][c]+f[6][c]+f[7][c],l[c]=f[8][c]+f[9][c]+f[10][c]+f[11][c]+f[12][c]+f[13][c]+f[14][c]+f[15][c];m[0].process(k,k);m[1].process(k,k);m[2].process(k,k);m[3].process(k,k);m[4].process(l,l);m[5].process(l,l);m[6].process(l,
l);m[7].process(l,l);for(c=0;c<z;++c)d[c]=k[c]*r+d[c]*w,b[c]=l[c]*r+b[c]*w};h.prototype.process=function(d,b){var c=this.buffer,f=this.buffersize,m=this.bufidx,k=this.filterstore,l=this.feedback,r=this.damp,w=1-r,z,C=d.length;for(z=0;z<C;++z){var F=.015*d[z];var D=c[m];k=D*w+k*r;c[m]=F+k*l;++m>=f&&(m=0);b[z]=D}this.bufidx=m;this.filterstore=k};n.prototype.process=function(d,b){var c=this.buffer,f=this.buffersize,m=this.bufidx,k,l=d.length;for(k=0;k<l;++k){var r=d[k];var w=c[m];var z=-r+w;c[m]=r+.5*
w;++m>=f&&(m=0);b[k]=z}this.bufidx=m};u.modules.Reverb=t})(timbre);
(function(u){function t(d){return new h(d)}function h(d){this.fragments=[];d&&this.fragments.push(new n(d,0,d.buffer[0].length/(d.samplerate||44100)))}function n(d,b,c,f,m,k,l){d||=a;this.buffer=d.buffer[0];this.samplerate=d.samplerate||44100;this.start=b;this._duration=c;this.reverse=f||!1;this.pitch=m||100;this.stretch=k||!1;this.pan=l||50}function g(d,b){this.tape=d;this.fragments=d.fragments;this.samplerate=b||44100;this.isEnded=!1;this.buffer=null;this.bufferEndIndex=this.bufferBeginIndex=this.bufferIndexIncr=
this.bufferIndex=0;this.fragment=null;this.fragmentIndex=0;this.panR=this.panL=.5}var e=new Float32Array(60),a={buffer:e,samplerate:1};t.silence=function(d){return(new t(a)).slice(0,1).fill(d)};t.join=function(d){for(var b=new h,c=0;c<d.length;c++)d[c]instanceof h&&b.add_fragments(d[c].fragments);return b};t.Tape=h;h.prototype.add_fragment=function(d){this.fragments.push(d);return this};h.prototype.add_fragments=function(d){for(var b=0;b<d.length;b++)this.fragments.push(d[b]);return this};h.prototype.duration=
function(){for(var d=0,b=0;b<this.fragments.length;b++)d+=this.fragments[b].duration();return d};h.prototype.slice=function(d,b){var c=this.duration();d+b>c&&(b=c-d);c=new h;var f=b;for(b=0;b<this.fragments.length;b++){f=this.fragments[b].create(d,f);var m=f[0];d=f[1];f=f[2];m&&c.add_fragment(m);if(0===f)break}return c};h.prototype.cut=h.prototype.slice;h.prototype.concat=function(d){var b=new h;b.add_fragments(this.fragments);b.add_fragments(d.fragments);return b};h.prototype.loop=function(d){var b,
c=[];for(b=0;b<this.fragments.length;b++)c.push(this.fragments[b].clone());var f=new h;for(b=0;b<d;b++)f.add_fragments(c);return f};h.prototype.times=h.prototype.loop;h.prototype.split=function(d){for(var b=this.duration()/d,c=[],f=0;f<d;f++)c.push(this.slice(f*b,b));return c};h.prototype.fill=function(d){var b=this.duration();if(0===b)throw"EmptyFragment";var c=d%b;return this.loop(d/b|0).plus(this.slice(0,c))};h.prototype.replace=function(d,b,c){var f=new h;b=d+b;f=f.plus(this.slice(0,d));var m=
f.duration();m<d&&(f=f.plus(t.silence(d-m)));f=f.plus(c);d=this.duration();d>b&&(f=f.plus(this.slice(b,d-b)));return f};h.prototype.reverse=function(){for(var d=new h,b=this.fragments.length;b--;){var c=this.fragments[b].clone();c.reverse=!c.isReversed();d.add_fragment(c)}return d};h.prototype.pitch=function(d,b){var c=new h;b=b||!1;for(var f=0;f<this.fragments.length;f++){var m=this.fragments[f].clone();m.pitch=.01*m.pitch*d;m.stretch=b;c.add_fragment(m)}return c};h.prototype.stretch=function(d){return this.pitch(1/
(.01*d)*100,!0)};h.prototype.pan=function(d){var b=new h;100<d?d=100:0>d&&(d=0);for(var c=0;c<this.fragments.length;c++){var f=this.fragments[c].clone();f.pan=d;b.add_fragment(f)}return b};h.prototype.silence=function(){return t.silence(this.duration())};h.prototype.join=function(d){for(var b=new h,c=0;c<d.length;c++)d[c]instanceof h&&b.add_fragments(d[c].fragments);return b};h.prototype.getBuffer=function(){var d=44100;0<this.fragments.length&&(d=this.fragments[0].samplerate);var b=new g(this,d),
c=this.duration()*d|0;return{samplerate:d,buffer:b.fetch(c)}};n.prototype.duration=function(){return 100/this.pitch*this._duration};n.prototype.original_duration=function(){return this._duration};n.prototype.isReversed=function(){return this.reverse};n.prototype.isStretched=function(){return this.stretched};n.prototype.create=function(d,b){var c=this.duration();if(d>=c)return[null,d-c,b];d+b>=c?(c-=d,b-=c):(c=b,b=0);var f=this.clone();f.start=this.start+d*this.pitch*.01;f._duration=c*this.pitch*.01;
f.reverse=!1;return[f,0,b]};n.prototype.clone=function(){var d=new n;d.buffer=this.buffer;d.samplerate=this.samplerate;d.start=this.start;d._duration=this._duration;d.reverse=this.reverse;d.pitch=this.pitch;d.stretch=this.stretch;d.pan=this.pan;return d};t.Fragment=n;t.TapeStream=g;g.prototype.reset=function(){this.isEnded=!1;this.buffer=null;this.bufferEndIndex=this.bufferBeginIndex=this.bufferIndexIncr=this.bufferIndex=0;this.fragment=null;this.fragmentIndex=0;this.panR=this.panL=.5;this.isLooped=
!1;return this};g.prototype.fetch=function(d){var b=new u.fn.SignalArray(d),c=new u.fn.SignalArray(d),f=this.fragments;if(0===f.length)return[b,c];for(var m=100*this.samplerate,k=this.buffer,l=this.bufferIndex,r=this.bufferIndexIncr,w=this.bufferBeginIndex,z=this.bufferEndIndex,C=this.fragment,F=this.fragmentIndex,D=this.panL,E=this.panR,H=0;H<d;H++){for(;!k||l<w||l>=z;)if(!C||F<f.length)C=f[F++],k=C.buffer,r=C.samplerate/m*C.pitch,w=C.start*C.samplerate,z=w+C.original_duration()*C.samplerate,l=.01*
C.pan,D=1-l,E=l,C.reverse?(r*=-1,l=z+r):l=w;else if(this.isLooped)k=null,z=w=r=l=0,C=null,F=0;else{this.isEnded=!0;k=e;l=r=0;break}b[H]=k[l|0]*D;c[H]=k[l|0]*E;l+=r}this.buffer=k;this.bufferIndex=l;this.bufferIndexIncr=r;this.bufferBeginIndex=w;this.bufferEndIndex=z;this.fragment=C;this.fragmentIndex=F;this.panL=D;this.panR=E;return[b,c]};u.modules.Scissor=t})(timbre);
(function(u){function t(n){this.samplerate=n;this.buffersize=1<<Math.ceil(Math.log(1.5*n)*Math.LOG2E);this.buffermask=this.buffersize-1;this.writeBufferL=new u.fn.SignalArray(this.buffersize);this.writeBufferR=new u.fn.SignalArray(this.buffersize);this.readBufferL=this.writeBufferL;this.readBufferR=this.writeBufferR;this.mix=this.cross=this.feedback=this.delaytime=null;this.writeIndex=this.readIndex=this.prevR=this.prevL=0;this.setParams(125,.25,!1,.45)}var h=t.prototype;h.setParams=function(n,g,
e,a){this.delaytime!==n&&(this.delaytime=n,n=.001*n*this.samplerate|0,n>this.buffermask&&(n=this.buffermask),this.writeIndex=this.readIndex+n&this.buffermask);this.feedback!==g&&(this.feedback=g);this.cross!==e&&((this.cross=e)?(this.readBufferL=this.writeBufferR,this.readBufferR=this.writeBufferL):(this.readBufferL=this.writeBufferL,this.readBufferR=this.writeBufferR));this.mix!==a&&(this.mix=a)};h.process=function(n,g){var e=this.readBufferL,a=this.readBufferR,d=this.writeBufferL,b=this.writeBufferR,
c=this.readIndex,f=this.writeIndex,m=this.buffermask,k=this.feedback,l=this.mix,r=1-l,w=this.prevL,z=this.prevR,C,F=n.length;for(C=0;C<F;++C){var D=e[c];d[f]=n[C]-D*k;n[C]=w=.5*(n[C]*r+D*l+w);D=a[c];b[f]=g[C]-D*k;g[C]=z=.5*(g[C]*r+D*l+z);c+=1;f=f+1&m}this.readIndex=c&this.buffermask;this.writeIndex=f;this.prevL=w;this.prevR=z};u.modules.StereoDelay=t})(timbre);
(function(u){var t=u.fn,h=u.modules;t.register("audio",function(e){e=new (t.getClass("buffer"))(e);e.playbackState=t.FINISHED_STATE;e._.isLoaded=!1;Object.defineProperties(e,{isLoaded:{get:function(){return this._.isLoaded}}});e.load=n;e.loadthis=g;return e});var n=function(e){var a=this,d=this._,b=new h.Deferred(this),c=arguments,f=1;b.done(function(){a._.emit("done")});"function"===typeof c[f]&&(b.done(c[f++]),"function"===typeof c[f]&&b.fail(c[f++]));d.loadedTime=0;(new h.Decoder).decode(e,function(m,
k){var l=a._;m?(a.playbackState=t.PLAYING_STATE,l.samplerate=m.samplerate,l.channels=m.channels,l.bufferMix=null,l.buffer=m.buffer,l.phase=0,l.phaseIncr=m.samplerate/u.samplerate,l.duration=1E3*m.duration,l.currentTime=0,l.isReversed&&(l.phaseIncr*=-1,l.phase=m.buffer[0].length+l.phaseIncr),a._.emit("loadedmetadata")):b.reject(k)},function(){a._.isLoaded=!0;a._.plotFlush=!0;a._.emit("loadeddata");b.resolveWith(a)});return b.promise()},g=function(){n.apply(this,arguments);return this}})(timbre);
(function(u){function t(c){u.Object.call(this,2,c);h.fixAR(this);c=this._;c.biquad=new g(c.samplerate);c.freq=u(340);c.band=u(1);c.gain=u(0);c.plotBefore=e;c.plotRange=[-18,18];c.plotFlush=!0}var h=u.fn,n=u.modules.FFT,g=u.modules.Biquad;h.extend(t);var e=function(c,f,m,k,l){c.lineWidth=1;c.strokeStyle="rgb(192, 192, 192)";for(var r=.5*this._.samplerate,w=1;10>=w;++w)for(var z=1;4>=z;z++){var C=w*Math.pow(10,z);20>=C||r<=C||(c.beginPath(),C=Math.log(C/20)/Math.log(r/20),C=(C*k+f|0)+.5,c.moveTo(C,
m),c.lineTo(C,m+l),c.stroke())}l/=6;for(w=1;6>w;w++)c.beginPath(),r=(m+w*l|0)+.5,c.moveTo(f,r),c.lineTo(f+k,r),c.stroke()},a=t.prototype;Object.defineProperties(a,{type:{set:function(c){var f=this._;c!==f.biquad.type&&(f.biquad.setType(c),f.plotFlush=!0)},get:function(){return this._.biquad.type}},freq:{set:function(c){this._.freq=u(c)},get:function(){return this._.freq}},cutoff:{set:function(c){this._.freq=u(c)},get:function(){return this._.freq}},res:{set:function(c){this._.band=u(c)},get:function(){return this._.band}},
Q:{set:function(c){this._.band=u(c)},get:function(){return this._.band}},band:{set:function(c){this._.band=u(c)},get:function(){return this._.band}},gain:{set:function(c){this._.gain=u(c)},get:function(){return this._.gain}}});a.process=function(c){var f=this._;if(this.tickID!==c){this.tickID=c;h.inputSignalAR(this);var m=f.freq.process(c).cells[0][0],k=f.band.process(c).cells[0][0];c=f.gain.process(c).cells[0][0];if(f.prevFreq!==m||f.prevband!==k||f.prevGain!==c)f.prevFreq=m,f.prevband=k,f.prevGain=
c,f.biquad.setParams(m,k,c),f.plotFlush=!0;f.bypassed||f.biquad.process(this.cells[1],this.cells[2]);h.outputSignalAR(this)}return this};var d=new n(2048),b=u.Object.prototype.plot;a.plot=function(c){if(this._.plotFlush){var f=new g(this._.samplerate);f.setType(this.type);f.setParams(this.freq.valueOf(),this.band.valueOf(),this.gain.valueOf());var m=new Float32Array(d.length);m[0]=1;f.process(m,m);d.forward(m);f=new Float32Array(512);m=.5*this._.samplerate;var k=new Float32Array(512),l;d.getFrequencyData(k);
for(l=0;512>l;++l){var r=20*Math.pow(m/20,l/512);var w=r/(m/k.length);r=w|0;w-=r;if(0===r)r=k[r];else{var z=k[r-1];r=k[r];r=(1-w)*z+w*r}f[l]=r}this._.plotData=f;this._.plotFlush=null}return b.call(this,c)};h.register("biquad",t);h.register("lowpass",function(c){return(new t(c)).set("type","lowpass")});h.register("highpass",function(c){return(new t(c)).set("type","highpass")});h.register("bandpass",function(c){return(new t(c)).set("type","bandpass")});h.register("lowshelf",function(c){return(new t(c)).set("type",
"lowshelf")});h.register("highshelf",function(c){return(new t(c)).set("type","highshelf")});h.register("peaking",function(c){return(new t(c)).set("type","peaking")});h.register("notch",function(c){return(new t(c)).set("type","notch")});h.register("allpass",function(c){return(new t(c)).set("type","allpass")});h.alias("lpf","lowpass");h.alias("hpf","highpass");h.alias("bpf","bandpass");h.alias("bef","notch");h.alias("brf","notch");h.alias("apf","allpass")})(timbre);
(function(u){function t(c){u.Object.call(this,1,c);h.fixAR(this);c=this._;c.pitch=u(1);c.samplerate=44100;c.channels=0;c.bufferMix=null;c.buffer=[];c.isLooped=!1;c.isReversed=!1;c.duration=0;c.currentTime=0;c.currentTimeObj=null;c.phase=0;c.phaseIncr=0;c.onended=h.make_onended(this,0);c.onlooped=e(this)}var h=u.fn,n=u.modules.Scissor.Tape,g=function(c){return h.isSignalArray(c)||c instanceof Float32Array};h.extend(t);var e=function(c){return function(){var f=c._;f.phase>=f.buffer[0].length?f.phase=
0:0>f.phase&&(f.phase=f.buffer[0].length+f.phaseIncr);c._.emit("looped")}},a=t.prototype,d=function(c){var f=this._;if("object"===typeof c){var m=[];if(g(c))m[0]=c;else if("object"===typeof c&&(c instanceof u.Object?c=c.buffer:c instanceof n&&(c=c.getBuffer()),Array.isArray(c.buffer)?g(c.buffer[0])&&(m=g(c.buffer[1])&&g(c.buffer[2])?c.buffer:[c.buffer[0]]):g(c.buffer)&&(m=[c.buffer]),"number"===typeof c.samplerate))var k=c.samplerate;m.length&&(0<k&&(f.samplerate=c.samplerate),f.bufferMix=null,f.buffer=
m,f.phase=0,f.phaseIncr=f.samplerate/u.samplerate,f.duration=1E3*f.buffer[0].length/f.samplerate,f.currentTime=0,f.plotFlush=!0,this.reverse(f.isReversed))}};Object.defineProperties(a,{buffer:{set:d,get:function(){var c=this._;return{samplerate:c.samplerate,channels:c.channels,buffer:c.buffer}}},pitch:{set:function(c){this._.pitch=u(c)},get:function(){return this._.pitch}},isLooped:{get:function(){return this._.isLooped}},isReversed:{get:function(){return this._.isReversed}},samplerate:{get:function(){return this._.samplerate}},
duration:{get:function(){return this._.duration}},currentTime:{set:function(c){if("number"===typeof c){var f=this._;0<=c&&c<=f.duration&&(f.phase=c/1E3*f.samplerate,f.currentTime=c)}else c instanceof u.Object?this._.currentTimeObj=c:null===c&&(this._.currentTimeObj=null)},get:function(){return this._.currentTimeObj?this._.currentTimeObj:this._.currentTime}}});a.clone=function(){var c=this._,f=h.clone(this);c.buffer.length&&d.call(f,{buffer:c.buffer,samplerate:c.samplerate,channels:c.channels});f.loop(c.isLooped);
f.reverse(c.isReversed);return f};a.slice=function(c,f){var m=this._,k=u(m.originkey);if(m.buffer.length){c="number"===typeof c?.001*c*m.samplerate|0:0;f="number"===typeof f?.001*f*m.samplerate|0:m.buffer[0].length;if(c>f){var l=c;c=f;f=l}2===m.channels?d.call(k,{buffer:[h.pointer(m.buffer[0],c,f-c),h.pointer(m.buffer[1],c,f-c),h.pointer(m.buffer[2],c,f-c)],samplerate:m.samplerate}):d.call(k,{buffer:h.pointer(m.buffer[0],c,f-c),samplerate:m.samplerate});k.playbackState=h.PLAYING_STATE}k.loop(m.isLooped);
k.reverse(m.isReversed);return k};a.reverse=function(c){var f=this._;f.isReversed=!!c;f.isReversed?(0<f.phaseIncr&&(f.phaseIncr*=-1),0===f.phase&&f.buffer.length&&(f.phase=f.buffer[0].length+f.phaseIncr)):0>f.phaseIncr&&(f.phaseIncr*=-1);return this};a.loop=function(c){this._.isLooped=!!c;return this};a.bang=function(c){this.playbackState=!1===c?h.FINISHED_STATE:h.PLAYING_STATE;this._.phase=0;this._.emit("bang");return this};a.process=function(c){var f=this._;if(!f.buffer.length)return this;if(this.tickID!==
c){this.tickID=c;var m=this.cells[1],k=this.cells[2],l=f.phase,r=f.cellsize;if(2===f.channels){var w=f.buffer[1];var z=f.buffer[2]}else w=z=f.buffer[0];if(f.currentTimeObj){var C=f.currentTimeObj.process(c).cells[0],F=.001*f.samplerate;for(c=0;c<r;++c){var D=C[c];l=D*F;m[c]=w[l|0]||0;k[c]=z[l|0]||0}f.phase=l;f.currentTime=D}else{c=f.pitch.process(c).cells[0][0];D=f.phaseIncr*c;for(c=0;c<r;++c)m[c]=w[l|0]||0,k[c]=z[l|0]||0,l+=D;l>=w.length?f.isLooped?h.nextTick(f.onlooped):h.nextTick(f.onended):0>
l&&(f.isLooped?h.nextTick(f.onlooped):h.nextTick(f.onended));f.phase=l;f.currentTime+=h.currentTimeIncr}h.outputSignalAR(this)}return this};var b=u.Object.prototype.plot;a.plot=function(c){var f=this._;if(f.plotFlush){if(2===f.channels){var m=f.buffer[1];var k=f.buffer[2]}else m=k=f.buffer[0];for(var l=new Float32Array(2048),r=0,w=m.length/2048,z=0;2048>z;z++)l[z]=.5*(m[r|0]+k[r|0]),r+=w;f.plotData=l;f.plotFlush=null}return b.call(this,c)};h.register("buffer",t)})(timbre);
(function(u){function t(e){u.Object.call(this,2,e);h.fixAR(this);e=new n(this._.samplerate);e.setDelayTime(20);e.setRate(4);e.depth=20;e.feedback=.2;e.mix=.33;this._.chorus=e}var h=u.fn,n=u.modules.Chorus;h.extend(t);var g=t.prototype;Object.defineProperties(g,{type:{set:function(e){this._.chorus.setDelayTime(e)},get:function(){return this._.chorus.wave}},delay:{set:function(e){.5<=e&&80>=e&&this._.chorus.setDelayTime(e)},get:function(){return this._.chorus.delayTime}},rate:{set:function(e){"number"===
typeof e&&0<e&&this._.chorus.setRate(e)},get:function(){return this._.chorus.rate}},depth:{set:function(e){"number"===typeof e&&0<=e&&100>=e&&(e*=this._.samplerate/44100,this._.chorus.depth=e)},get:function(){return this._.chorus.depth}},fb:{set:function(e){"number"===typeof e&&-1<=e&&1>=e&&(this._.chorus.feedback=.99996*e)},get:function(){return this._.chorus.feedback}},mix:{set:function(e){this._.mix=u(e)},get:function(){return this._.mix}}});g.process=function(e){var a=this._;this.tickID!==e&&
(this.tickID=e,h.inputSignalAR(this),a.bypassed||a.chorus.process(this.cells[1],this.cells[2]),h.outputSignalAR(this));return this};h.register("chorus",t)})(timbre);
(function(u){function t(g){u.Object.call(this,2,g);g=this._;g.min=-.8;g.max=.8}var h=u.fn;h.extend(t);var n=t.prototype;Object.defineProperties(n,{minmax:{set:function(g){var e=this._;"number"===typeof g&&(e.min=-Math.abs(g),e.max=-e.min)},get:function(){return this._.max}},min:{set:function(g){var e=this._;"number"===typeof g&&(e.max<g?e.max=g:e.min=g)},get:function(){return this._.min}},max:{set:function(g){var e=this._;"number"===typeof g&&(g<e.min?e.min=g:e.max=g)},get:function(){return this._.max}}});
n.process=function(g){var e=this._;if(this.tickID!==g){this.tickID=g;g=this.cells[1];var a=this.cells[2],d=g.length,b=e.min,c=e.max;if(e.ar){h.inputSignalAR(this);for(e=0;e<d;++e){var f=g[e];f<b?f=b:f>c&&(f=c);g[e]=f;f=a[e];f<b?f=b:f>c&&(f=c);a[e]=f}h.outputSignalAR(this)}else f=h.inputSignalKR(this),f<b?f=b:f>c&&(f=c),this.cells[0][0]=f,h.outputSignalKR(this)}return this};h.register("clip",t)})(timbre);
(function(u){function t(a){u.Object.call(this,2,a);h.fixAR(this);a=this._;a.prevThresh=-24;a.prevKnee=30;a.prevRatio=12;a.thresh=u(a.prevThresh);a.knee=u(a.prevKnee);a.ratio=u(a.prevRatio);a.postGain=6;a.reduction=0;a.attack=3;a.release=25;a.comp=new g(a.samplerate);a.comp.dbPostGain=a.postGain;a.comp.setAttackTime(.001*a.attack);a.comp.setReleaseTime(.001*a.release);a.comp.setPreDelayTime(6);a.comp.setParams(a.prevThresh,a.prevKnee,a.prevRatio)}var h=u.fn,n=u.timevalue,g=u.modules.Compressor;h.extend(t);
var e=t.prototype;Object.defineProperties(e,{thresh:{set:function(a){this._.thresh=u(a)},get:function(){return this._.thresh}},thre:{set:function(a){this._.thresh=u(a)},get:function(){return this._.thre}},knee:{set:function(a){this._.kne=u(a)},get:function(){return this._.knee}},ratio:{set:function(a){this._.ratio=u(a)},get:function(){return this._.ratio}},gain:{set:function(a){"number"===typeof a&&(this._.comp.dbPostGain=a)},get:function(){return this._.comp.dbPostGain}},attack:{set:function(a){"string"===
typeof a&&(a=n(a));"number"===typeof a&&(a=0>a?0:1E3<a?1E3:a,this._.attack=a,this._.comp.setAttackTime(.001*a))},get:function(){return this._.attack}},release:{set:function(a){"string"===typeof a&&(a=n(a));"number"===typeof a&&(a=0>a?0:1E3<a?1E3:a,this._.release=a,this._.comp.setReleaseTime(.001*a))},get:function(){return this._.release}},reduction:{get:function(){return this._.reduction}}});e.process=function(a){var d=this._;if(this.tickID!==a){this.tickID=a;h.inputSignalAR(this);var b=d.thresh.process(a).cells[0][0],
c=d.knee.process(a).cells[0][0];a=d.ratio.process(a).cells[0][0];if(d.prevThresh!==b||d.prevKnee!==c||d.prevRatio!==a)d.prevThresh=b,d.prevKnee=c,d.prevRatio=a,d.comp.setParams(b,c,a);d.bypassed||(d.comp.process(this.cells[1],this.cells[2]),d.reduction=d.comp.meteringGain);h.outputSignalAR(this)}return this};h.register("comp",t)})(timbre);
(function(u){function t(a){u.Object.call(this,2,a);h.fixAR(this);a=this._;a.time=u(100);a.fb=u(.2);a.cross=u(!1);a.mix=.33;a.delay=new g(a.samplerate)}var h=u.fn,n=u.timevalue,g=u.modules.StereoDelay;h.extend(t);var e=t.prototype;Object.defineProperties(e,{time:{set:function(a){"string"===typeof a&&(a=n(a));this._.time=u(a)},get:function(){return this._.time}},fb:{set:function(a){this._.fb=u(a)},get:function(){return this._.fb}},cross:{set:function(a){this._.cross=u(a)},get:function(){return this._.cross}},
mix:{set:function(a){"number"===typeof a&&(this._.mix=1<a?1:0>a?0:a)},get:function(){return this._.mix}}});e.process=function(a){var d=this._;if(this.tickID!==a){this.tickID=a;var b=d.time.process(a).cells[0][0],c=d.fb.process(a).cells[0][0];a=0!==d.cross.process(a).cells[0][0];var f=d.mix;if(d.prevTime!==b||d.prevFb!==c||d.prevCross!==a||d.prevMix!==f)d.prevTime=b,d.prevFb=c,d.prevCross=a,d.prevMix=f,d.delay.setParams(b,c,a,f);h.inputSignalAR(this);d.bypassed||d.delay.process(this.cells[1],this.cells[2]);
h.outputSignalAR(this)}return this};h.register("delay",t)})(timbre);
(function(u){function t(g){u.Object.call(this,2,g);h.fixAR(this);g=this._;g.pre=u(60);g.post=u(-18);g.x1L=g.x2L=g.y1L=g.y2L=0;g.x1R=g.x2R=g.y1R=g.y2R=0;g.b0=g.b1=g.b2=g.a1=g.a2=0;g.cutoff=0;g.Q=1;g.preScale=0;g.postScale=0}var h=u.fn;h.extend(t);var n=t.prototype;Object.defineProperties(n,{cutoff:{set:function(g){"number"===typeof g&&0<g&&(this._.cutoff=g)},get:function(){return this._.cutoff}},pre:{set:function(g){this._.pre=u(g)},get:function(){return this._.pre}},post:{set:function(g){this._.post=
u(g)},get:function(){return this._.post}}});n.process=function(g){var e=this._;if(this.tickID!==g){this.tickID=g;h.inputSignalAR(this);var a=-e.pre.process(g).cells[0][0];g=-e.post.process(g).cells[0][0];if(e.prevPreGain!==a||e.prevPostGain!==g)e.prevPreGain=a,e.prevPostGain=g,e.preScale=Math.pow(10,.05*-a),e.postScale=Math.pow(10,.05*-g);if(!e.bypassed){a=this.cells[1];g=this.cells[2];var d=e.preScale,b=e.postScale;if(e.cutoff){if(e.prevCutoff!==e.cutoff){e.prevCutoff=e.cutoff;var c=2*Math.PI*e.cutoff/
e.samplerate;var f=Math.cos(c);c=Math.sin(c)/(2*e.Q);var m=1/(1+c);e.b0=.5*(1-f)*m;e.b1=1-f*m;e.b2=.5*(1-f)*m;e.a1=-2*f*m;e.a2=1-c*m}var k=e.x1L,l=e.x2L,r=e.y1L,w=e.y2L,z=e.x1R,C=e.x2R,F=e.y1R,D=e.y2R,E=e.b0,H=e.b1,L=e.b2,K=e.a1,N=e.a2;f=0;for(c=a.length;f<c;++f){var Q=a[f]*d;var R=E*Q+H*k+L*l-K*r-N*w;m=R*b;-1>m?m=-1:1<m&&(m=1);a[f]=m;l=k;k=Q;w=r;r=R;Q=g[f]*d;R=E*Q+H*z+L*C-K*F-N*D;m=R*b;-1>m?m=-1:1<m&&(m=1);g[f]=m;C=z;z=Q;D=F;F=R}e.x1L=k;e.x2L=l;e.y1L=r;e.y2L=w;e.x1R=z;e.x2R=C;e.y1R=F;e.y2R=D}else for(f=
0,c=a.length;f<c;++f)m=a[f]*d*b,-1>m?m=-1:1<m&&(m=1),a[f]=m,m=g[f]*d*b,-1>m?m=-1:1<m&&(m=1),g[f]=m}h.outputSignalAR(this)}return this};h.register("dist",t)})(timbre);
(function(u){function t(n){u.Object.call(this,2,n);this._.ar=!1}var h=u.fn;h.extend(t);t.prototype.process=function(n){var g=this._;if(this.tickID!==n){this.tickID=n;var e=this.nodes,a=this.cells[0],d=this.cells[1],b=this.cells[2],c,f=e.length,m=a.length;if(g.ar){if(0<e.length){e[0].process(n);var k=e[0].cells[1];var l=e[0].cells[2];d.set(k);b.set(l);for(c=1;c<f;++c)for(e[c].process(n),k=e[c].cells[1],l=e[c].cells[2],a=0;a<m;++a)g=k[a],d[a]=0===g?0:d[a]/g,g=l[a],b[a]=0===g?0:b[a]/g}else for(a=0;a<
m;++a)d[a]=b[c]=0;h.outputSignalAR(this)}else{if(0<e.length)for(d=e[0].process(n).cells[0][0],c=1;c<f;++c)g=e[c].process(n).cells[0][0],d=0===g?0:d/g;else d=0;a[0]=d;h.outputSignalKR(this)}}return this};h.register("/",t)})(timbre);
(function(u){function t(k){u.Object.call(this,2,k);k=this._;k.env=new e(k.samplerate);k.env.setStep(k.cellsize);k.tmp=new n.SignalArray(k.cellsize);k.ar=!1;k.plotFlush=!0;k.onended=b(this);this.on("ar",d)}function h(k,l,r,w,z,C){"number"===typeof k[w]?r=k[w]:"number"===typeof k[z]?r=k[z]:C&&("string"===typeof k[w]?r=C(k[w]):"string"===typeof k[z]&&(r=C(k[z])));r<l&&(r=l);return r}var n=u.fn,g=u.timevalue,e=u.modules.Envelope,a=n.isDictionary;n.extend(t);var d=function(k){this._.env.setStep(k?1:this._.cellsize)},
b=function(k){return function(){k._.emit("ended")}},c=t.prototype;Object.defineProperties(c,{table:{set:function(k){if(Array.isArray(k)){for(var l=this._.env,r=[k[0]||m],w,z,C,F,D=1,E=k.length;D<E;++D)w=k[D][0]||m,z=k[D][1],C=k[D][2],"number"!==typeof z&&(z="string"===typeof z?g(z):10),10>z&&(z=10),"number"===typeof C?(F=C,C=e.CurveTypeCurve):(C=e.CurveTypeDict[C]||null,F=0),r.push([w,z,C,F]);l.setTable(r);this._.plotFlush=!0}},get:function(){return this._.env.table}},curve:{set:function(k){this._.env.setCurve(k)},
get:function(){return this._.env.curve}},releaseNode:{set:function(k){this._.env.setReleaseNode(k);this._.plotFlush=!0},get:function(){return this._.env.releaseNode+1}},loopNode:{set:function(k){this._.env.setLoopNode(k);this._.plotFlush=!0},get:function(){return this._.env.loopNode+1}}});c.clone=function(){var k=n.clone(this);k._.env=this._.env.clone();return k};c.reset=function(){this._.env.reset();return this};c.release=function(){var k=this._;k.env.release();k.emit("released");return this};c.bang=
function(){var k=this._;k.env.reset();k.env.status=e.StatusGate;k.emit("bang");return this};c.process=function(k){var l=this._;if(this.tickID!==k){this.tickID=k;k=this.cells[1];var r=this.cells[2],w,z=l.cellsize;if(this.nodes.length)n.inputSignalAR(this);else for(w=0;w<z;++w)k[w]=r[w]=1;if(l.ar){var C=l.tmp;l.env.process(C);for(w=0;w<z;++w)k[w]*=C[w],r[w]*=C[w]}else for(C=l.env.next(),w=0;w<z;++w)k[w]*=C,r[w]*=C;k=l.env.emit;n.outputSignalAR(this);k&&("ended"===k?n.nextTick(l.onended):this._.emit(k,
l.value))}return this};var f=u.Object.prototype.plot;c.plot=function(k){if(this._.plotFlush){var l=this._.env.clone(),r=l.getInfo(1E3),w=r.totalDuration,z=r.loopBeginTime,C=r.releaseBeginTime;r=new Float32Array(256);var F=0,D=w/r.length,E=!1,H=.001*w*this._.samplerate|0,L;H/=r.length;l.setStep(H);l.status=e.StatusGate;H=0;for(L=r.length;H<L;++H)r[H]=l.next(),F+=D,!E&&F>=C&&(l.release(),E=!0);this._.plotData=r;this._.plotBefore=function(K,N,Q,R,Y){if(Infinity!==z&&Infinity!==C){Q=N+z/w*R;var W=N+C/
w*R;K.fillStyle="rgba(224, 224, 224, 0.8)";K.fillRect(Q,0,W-Q,Y)}Infinity!==C&&(Q=N+C/w*R,K.fillStyle="rgba(212, 212, 212, 0.8)",K.fillRect(Q,0,R-Q,Y))};l=Infinity;F=-Infinity;for(H=0;H<L;++H)r[H]<l?l=r[H]:r[H]>F&&(F=r[H]);1>F&&(F=1);this._.plotRange=[l,F];this._.plotData=r;this._.plotFlush=null}return f.call(this,k)};n.register("env",t);var m=e.ZERO;n.register("perc",function(k){a(k[0])||k.unshift({});var l=k[0],r=h(l,10,10,"a","attackTime",g),w=h(l,10,1E3,"r","releaseTime",g),z=h(l,m,1,"lv","level");
l.table=[m,[z,r],[m,w]];return new t(k)});n.register("adsr",function(k){a(k[0])||k.unshift({});var l=k[0],r=h(l,10,10,"a","attackTime",g),w=h(l,10,300,"d","decayTime",g),z=h(l,m,.5,"s","sustainLevel"),C=h(l,10,1E3,"r","decayTime",g),F=h(l,m,1,"lv","level");l.table=[m,[F,r],[z,w],[m,C]];l.releaseNode=3;return new t(k)});n.register("adshr",function(k){a(k[0])||k.unshift({});var l=k[0],r=h(l,10,10,"a","attackTime",g),w=h(l,10,300,"d","decayTime",g),z=h(l,m,.5,"s","sustainLevel"),C=h(l,10,500,"h","holdTime",
g),F=h(l,10,1E3,"r","decayTime",g),D=h(l,m,1,"lv","level");l.table=[m,[D,r],[z,w],[z,C],[m,F]];return new t(k)});n.register("asr",function(k){a(k[0])||k.unshift({});var l=k[0],r=h(l,10,10,"a","attackTime",g),w=h(l,m,.5,"s","sustainLevel"),z=h(l,10,1E3,"r","releaseTime",g);l.table=[m,[w,r],[m,z]];l.releaseNode=2;return new t(k)});n.register("dadsr",function(k){a(k[0])||k.unshift({});var l=k[0],r=h(l,10,100,"dl","delayTime",g),w=h(l,10,10,"a","attackTime",g),z=h(l,10,300,"d","decayTime",g),C=h(l,m,
.5,"s","sustainLevel"),F=h(l,10,1E3,"r","relaseTime",g),D=h(l,m,1,"lv","level");l.table=[m,[m,r],[D,w],[C,z],[m,F]];l.releaseNode=4;return new t(k)});n.register("ahdsfr",function(k){a(k[0])||k.unshift({});var l=k[0],r=h(l,10,10,"a","attackTime",g),w=h(l,10,10,"h","holdTime",g),z=h(l,10,300,"d","decayTime",g),C=h(l,m,.5,"s","sustainLevel"),F=h(l,10,5E3,"f","fadeTime",g),D=h(l,10,1E3,"r","relaseTime",g),E=h(l,m,1,"lv","level");l.table=[m,[E,r],[E,w],[C,z],[m,F],[m,D]];l.releaseNode=5;return new t(k)});
n.register("linen",function(k){a(k[0])||k.unshift({});var l=k[0],r=h(l,10,10,"a","attackTime",g),w=h(l,10,1E3,"s","sustainTime",g),z=h(l,10,1E3,"r","releaseTime",g),C=h(l,m,1,"lv","level");l.table=[m,[C,r],[C,w],[m,z]];return new t(k)});n.register("env.tri",function(k){a(k[0])||k.unshift({});var l=k[0],r=h(l,20,1E3,"dur","duration",g),w=h(l,m,1,"lv","level");r*=.5;l.table=[m,[w,r],[m,r]];return new t(k)});n.register("env.cutoff",function(k){a(k[0])||k.unshift({});var l=k[0],r=h(l,10,100,"r","relaseTime",
g),w=h(l,m,1,"lv","level");l.table=[w,[m,r]];return new t(k)})})(timbre);
(function(u){function t(f){u.Object.call(this,2,f);h.fixAR(this);f=this._;f.biquads=Array(7);f.plotBefore=a;f.plotRange=[-18,18];f.plotFlush=!0}var h=u.fn,n=u.modules.FFT,g=u.modules.Biquad,e={hpf:0,lf:1,lmf:2,mf:3,hmf:4,hf:5,lpf:6};h.extend(t);var a=function(f,m,k,l,r){f.lineWidth=1;f.strokeStyle="rgb(192, 192, 192)";for(var w=.5*this._.samplerate,z=1;10>=z;++z)for(var C=1;4>=C;C++){var F=z*Math.pow(10,C);20>=F||w<=F||(f.beginPath(),F=Math.log(F/20)/Math.log(w/20),F=(F*l+m|0)+.5,f.moveTo(F,k),f.lineTo(F,
k+r),f.stroke())}r/=6;for(z=1;6>z;z++)f.beginPath(),w=(k+z*r|0)+.5,f.moveTo(m,w),f.lineTo(m+l,w),f.stroke()},d=t.prototype;Object.defineProperties(d,{params:{set:function(f){if("object"===typeof f)for(var m=Object.keys(f),k=0,l=m.length;k<l;++k){var r=f[m[k]];Array.isArray(r)?this.setParams(m[k],r[0],r[1],r[2]):this.setParams(m[k])}}}});d.setParams=function(f,m,k,l){var r=this._;"string"===typeof f&&(f=e[f]);if(0<=f&&f<r.biquads.length){f|=0;if("number"===typeof m&&"number"===typeof k){"number"!==
typeof l&&(l=0);var w=r.biquads[f];if(!w)switch(w=r.biquads[f]=new g(r.samplerate),f){case 0:w.setType("highpass");break;case r.biquads.length-1:w.setType("lowpass");break;default:w.setType("peaking")}w.setParams(m,k,l)}else r.biquads[f]=void 0;r.plotFlush=!0}return this};d.getParams=function(f){if(f=this._.biquads[f|0])return{freq:f.frequency,Q:f.Q,gain:f.gain}};d.process=function(f){var m=this._;if(this.tickID!==f){this.tickID=f;h.inputSignalAR(this);if(!m.bypassed){f=this.cells[1];var k=this.cells[2];
m=m.biquads;for(var l=0,r=m.length;l<r;++l)m[l]&&m[l].process(f,k)}h.outputSignalAR(this)}return this};var b=new n(2048),c=u.Object.prototype.plot;d.plot=function(f){if(this._.plotFlush){var m=this._,k=new Float32Array(b.length);k[0]=1;for(var l=0,r=m.biquads.length;l<r;++l){var w=this.getParams(l);if(w){var z=new g(m.samplerate);0===l?z.setType("highpass"):l===r-1?z.setType("lowpass"):z.setType("peaking");z.setParams(w.freq,w.Q,w.gain);z.process(k,k)}}b.forward(k);k=new Float32Array(512);m=.5*m.samplerate;
r=new Float32Array(512);b.getFrequencyData(r);for(l=0;512>l;++l){w=20*Math.pow(m/20,l/512);z=w/(m/r.length);w=z|0;z-=w;if(0===w)w=r[w];else{var C=r[w-1];w=r[w];w=(1-z)*C+z*w}k[l]=w}this._.plotData=k;this._.plotFlush=null}return c.call(this,f)};h.register("eq",t)})(timbre);
(function(u){function t(a){u.Object.call(this,2,a);h.listener(this);h.fixAR(this);this.real=new u.ChannelObject(this);this.imag=new u.ChannelObject(this);this.cells[3]=this.real.cell;this.cells[4]=this.imag.cell;a=this._;a.fft=new n(2*a.cellsize);a.fftCell=new h.SignalArray(a.fft.length);a.prevCell=new h.SignalArray(a.cellsize);a.freqs=new h.SignalArray(a.fft.length>>1);a.plotFlush=!0;a.plotRange=[0,32];a.plotBarStyle=!0}var h=u.fn,n=u.modules.FFT;h.extend(t);var g=t.prototype;Object.defineProperties(g,
{window:{set:function(a){this._.fft.setWindow(a)},get:function(){return this._.fft.windowName}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}}});g.process=function(a){var d=this._;if(this.tickID!==a){this.tickID=a;h.inputSignalAR(this);h.outputSignalAR(this);a=this.cells[0];var b=d.cellsize;d.fftCell.set(d.prevCell);d.fftCell.set(a,b);d.fft.forward(d.fftCell);d.prevCell.set(a);d.plotFlush=!0;this.cells[3].set(d.fft.real.subarray(0,b));this.cells[4].set(d.fft.imag.subarray(0,
b))}return this};var e=u.Object.prototype.plot;g.plot=function(a){this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null);return e.call(this,a)};h.register("fft",t)})(timbre);
(function(u){function t(g){u.Object.call(this,1,g);h.fixAR(this);g=this._;g.freq=u(440);g.reg=32768;g.shortFlag=!1;g.phase=0;g.lastValue=0}var h=u.fn;h.extend(t);var n=t.prototype;Object.defineProperties(n,{shortFlag:{set:function(g){this._.shortFlag=!!g},get:function(){return this._.shortFlag}},freq:{set:function(g){this._.freq=u(g)},get:function(){return this._.freq}}});n.process=function(g){var e=this._,a=this.cells[0];if(this.tickID!==g){this.tickID=g;var d=e.lastValue,b=e.phase;g=e.freq.process(g).cells[0][0]/
e.samplerate;var c=e.reg,f=e.mul,m=e.add,k;if(e.shortFlag){var l=0;for(k=a.length;l<k;++l)1<=b&&(c>>=1,c|=((c^c>>6)&1)<<15,d=(c&1)-.5,--b),a[l]=d*f+m,b+=g}else for(l=0,k=a.length;l<k;++l)1<=b&&(c>>=1,c|=((c^c>>1)&1)<<15,d=(c&1)-.5,--b),a[l]=d*f+m,b+=g;e.reg=c;e.phase=b;e.lastValue=d}return this};h.register("fnoise",t)})(timbre);
(function(u){function t(e){u.Object.call(this,2,e);h.fixAR(this);this._.selected=0;this._.outputs=[]}var h=u.fn,n=function(){function e(a){u.Object.call(this,2,[]);h.fixAR(this);this._.parent=a}h.extend(e);e.prototype.process=function(a){this.tickID!==a&&(this.tickID=a,this._.parent.process(a));return this};return e}();h.extend(t);var g=t.prototype;Object.defineProperties(g,{selected:{set:function(e){var a=this._;if("number"===typeof e){a.selected=e;e=a.outputs;a=0;for(var d=e.length;a<d;++a)e[a]&&
(e[a].cells[0].set(h.emptycell),e[a].cells[1].set(h.emptycell),e[a].cells[2].set(h.emptycell))}},get:function(){return this._.selected}}});g.at=function(e){var a=this._,d=a.outputs[e];d||(a.outputs[e]=d=new n(this));return d};g.process=function(e){var a=this._;this.tickID!==e&&(this.tickID=e,h.inputSignalAR(this),h.outputSignalAR(this),e=a.outputs[a.selected])&&(e.cells[0].set(this.cells[0]),e.cells[1].set(this.cells[1]),e.cells[2].set(this.cells[2]));return this};h.register("gate",t)})(timbre);
(function(u){function t(e){u.Object.call(this,1,e);h.fixAR(this);e=this._;e.fft=new n(2*e.cellsize);e.fftCell=new h.SignalArray(this._.fft.length);e.realBuffer=new h.SignalArray(this._.fft.length);e.imagBuffer=new h.SignalArray(this._.fft.length)}var h=u.fn,n=u.modules.FFT;h.extend(t);var g=t.prototype;Object.defineProperties(g,{real:{set:function(e){this._.real=u(e)},get:function(){return this._.real}},imag:{set:function(e){this._.imag=u(e)},get:function(){return this._.imag}}});g.process=function(e){var a=
this._;if(this.tickID!==e&&(this.tickID=e,a.real&&a.imag)){var d=this.cells[0],b=a.realBuffer,c=a.imagBuffer,f=a.real.process(e).cells[0];e=a.imag.process(e).cells[0];b.set(f);c.set(e);d.set(a.fft.inverse(b,c).subarray(0,a.cellsize));h.outputSignalAR(this)}return this};h.register("ifft",t)})(timbre);
(function(u){function t(a){u.Object.call(this,1,a);h.timer(this);h.fixKR(this);a=this._;a.interval=u(1E3);a.count=0;a.delay=0;a.timeout=Infinity;a.currentTime=0;a.delaySamples=0;a.countSamples=0;a.onended=h.make_onended(this);this.on("start",g)}var h=u.fn,n=u.timevalue;h.extend(t);var g=function(){var a=this._;this.playbackState=h.PLAYING_STATE;a.delaySamples=.001*a.samplerate*a.delay|0;a.countSamples=a.count=a.currentTime=0};Object.defineProperty(g,"unremovable",{value:!0,writable:!1});var e=t.prototype;
Object.defineProperties(e,{interval:{set:function(a){"string"===typeof a&&(a=n(a),0>=a&&(a=0));this._.interval=u(a)},get:function(){return this._.interval}},delay:{set:function(a){"string"===typeof a&&(a=n(a));"number"===typeof a&&0<=a&&(this._.delay=a,this._.delaySamples=.001*this._.samplerate*a|0)},get:function(){return this._.delay}},count:{set:function(a){"number"===typeof a&&(this._.count=a)},get:function(){return this._.count}},timeout:{set:function(a){"string"===typeof a&&(a=n(a));"number"===
typeof a&&0<=a&&(this._.timeout=a)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}});e.bang=function(){var a=this._;this.playbackState=h.PLAYING_STATE;a.delaySamples=.001*a.samplerate*a.delay|0;a.countSamples=a.count=a.currentTime=0;a.emit("bang");return this};e.process=function(a){var d=this.cells[0],b=this._;if(this.tickID!==a){this.tickID=a;0<b.delaySamples&&(b.delaySamples-=d.length);a=b.interval.process(a).cells[0][0];if(0>=b.delaySamples&&(b.countSamples-=
d.length,0>=b.countSamples)){b.countSamples+=b.samplerate*a*.001|0;a=this.nodes;for(var c=b.count,f=c*b.mul+b.add,m=0,k=d.length;m<k;++m)d[m]=f;d=0;for(f=a.length;d<f;++d)a[d].bang(c);b.count+=1}b.currentTime+=h.currentTimeIncr;b.currentTime>=b.timeout&&h.nextTick(b.onended)}return this};h.register("interval",t)})(timbre);
(function(u){function t(e){u.Object.call(this,1,e);h.fixAR(this);e=this._;e.buffersize=1<<Math.ceil(Math.log(e.samplerate)*Math.LOG2E);e.buffermask=e.buffersize-1;e.buffer=new h.SignalArray(e.buffersize);e.time=0;e.readIndex=0;e.writeIndex=0}var h=u.fn,n=u.timevalue;h.extend(t);var g=t.prototype;Object.defineProperties(g,{time:{set:function(e){"string"===typeof e&&(e=n(e));if("number"===typeof e&&0<e){var a=this._;a.time=e;e=.001*e*a.samplerate|0;e>a.buffermask&&(e=a.buffermask);a.writeIndex=a.readIndex+
e&a.buffermask}},get:function(){return this._.time}}});g.process=function(e){var a=this._;if(this.tickID!==e){this.tickID=e;h.inputSignalAR(this);e=this.cells[0];var d=a.buffer,b=a.buffermask,c=a.readIndex,f=a.writeIndex,m,k=e.length;for(m=0;m<k;++m)d[f]=e[m],e[m]=d[c],c+=1,f=f+1&b;a.readIndex=c&b;a.writeIndex=f;h.outputSignalAR(this)}return this};h.register("lag",t)})(timbre);
(function(u){function t(e){u.Object.call(this,1,e);e=this._;e.input=0;e.value=0;e.prev=null;e.ar=!1;e.map=n}var h=u.fn;h.extend(t);var n=function(e){return e},g=t.prototype;Object.defineProperties(g,{input:{set:function(e){"number"===typeof e&&(this._.input=e)},get:function(){return this._.input}},map:{set:function(e){"function"===typeof e&&(this._.map=e)},get:function(){return this._.map}}});g.bang=function(){this._.prev=null;this._.emit("bang");return this};g.at=function(e){return this._.map?this._.map(e):
0};g.process=function(e){var a=this.cells[0],d=this._;if(this.tickID!==e){this.tickID=e;var b=this.nodes.length;e=a.length;if(d.ar&&b){h.inputSignalAR(this);var c=d.map;if(c)for(b=0;b<e;++b)a[b]=c(a[b]);d.value=a[e-1];h.outputSignalAR(this)}else for(b=b?h.inputSignalKR(this):d.input,d.map&&d.prev!==b&&(d.prev=b,d.value=d.map(b)),d=d.value*d.mul+d.add,b=0;b<e;++b)a[b]=d}return this};h.register("map",t)})(timbre);
(function(u){function t(n){u.Object.call(this,1,n)}var h=u.fn;h.extend(t);t.prototype.process=function(n){var g=this.cells[0],e=this._;if(this.tickID!==n){this.tickID=n;var a=this.nodes,d=a.length,b,c=g.length;if(e.ar){if(0<a.length){var f=a[0].process(n).cells[0];g.set(f);for(e=1;e<d;++e)for(f=a[e].process(n).cells[0],b=0;b<c;++b){var m=f[b];g[b]<m&&(g[b]=m)}}else for(b=0;b<c;++b)g[b]=0;h.outputSignalAR(this)}else{if(0<a.length)for(f=a[0].process(n).cells[0][0],e=1;e<d;++e)m=a[e].process(n).cells[0][0],
f<m&&(f=m);else f=0;g[0]=f;h.outputSignalKR(this)}}return this};h.register("max",t)})(timbre);
(function(u){function t(a){u.Object.call(this,2,a);h.fixAR(this);a=this._;a.src=a.func=null;a.bufferL=new h.SignalArray(4096);a.bufferR=new h.SignalArray(4096);a.readIndex=0;a.writeIndex=0;a.totalRead=0;a.totalWrite=0}if("browser"===u.envtype){var h=u.fn;h.extend(t);var n=t.prototype;n.listen=function(a){var d=g[u.env];d&&(d.set.call(this,a),d.listen.call(this))};n.unlisten=function(){var a=g[u.env];a&&a.unlisten.call(this);this.cells[0].set(h.emptycell);this.cells[1].set(h.emptycell);this.cells[2].set(h.emptycell);
var d=this._;a=d.bufferL;d=d.bufferR;for(var b=0,c=a.length;b<c;++b)a[b]=d[b]=0};n.process=function(a){var d=this._;if(null===d.src)return this;if(this.tickID!==a){this.tickID=a;a=d.cellsize;if(d.totalWrite>d.totalRead+a){var b=d.readIndex,c=b+a;this.cells[1].set(d.bufferL.subarray(b,c));this.cells[2].set(d.bufferR.subarray(b,c));d.readIndex=c&4095;d.totalRead+=a}h.outputSignalAR(this)}return this};var g={webkit:{set:function(a){var d=this._;a instanceof HTMLMediaElement&&(d.src=h._audioContext.createMediaElementSource(a))},
listen:function(){var a=this._,d=h._audioContext;a.gain=d.createGain();a.gain.gain.value=0;a.node=d.createScriptProcessorNode(1024,2,2);a.node.onaudioprocess=e(this);a.src.connect(a.node);a.node.connect(a.gain);a.gain.connect(d.destination)},unlisten:function(){var a=this._;a.src&&a.src.disconnect();a.gain&&a.gain.disconnect();a.node&&a.node.disconnect()}}},e=function(a){return function(d){var b=a._;d=d.inputBuffer;var c=d.length,f=b.writeIndex;b.bufferL.set(d.getChannelData(0),f);b.bufferR.set(d.getChannelData(1),
f);b.writeIndex=f+c&4095;b.totalWrite+=c}};g.moz={set:function(a){var d=this._;a instanceof HTMLAudioElement&&(d.src=a,d.istep=d.samplerate/a.mozSampleRate)},listen:function(){var a=this._,d=a.bufferL,b=a.bufferR,c=0,f=0;2===a.src.mozChannels?(a.x=0,a.func=function(m){var k=a.writeIndex,l=a.totalWrite;m=m.frameBuffer;var r=a.istep,w,z=m.length;var C=a.x;for(w=0;w<z;w+=2){for(C+=r;0<C;)d[k]=.5*(m[w]+c),b[k]=.5*(m[w+1]+f),k=k+1&4095,++l,--C;c=m[w];f=m[w+1]}a.x=C;a.writeIndex=k;a.totalWrite=l}):(a.x=
0,a.func=function(m){var k=a.writeIndex,l=a.totalWrite;m=m.frameBuffer;var r=a.istep,w,z=m.length;var C=a.x;for(w=0;w<z;++w){for(C+=r;0<=C;)d[k]=b[k]=.5*(m[w]+c),k=k+1&4095,++l,--C;c=m[w]}a.x=C;a.writeIndex=k;a.totalWrite=l});a.src.addEventListener("MozAudioAvailable",a.func)},unlisten:function(){var a=this._;a.func&&(a.src.removeEventListener("MozAudioAvailable",a.func),a.func=null)}};h.register("mediastream",t)}})(timbre);
(function(u){function t(g){u.Object.call(this,1,g);g=this._;g.midi=0;g.value=0;g.prev=null;g.a4=440;g.ar=!1}var h=u.fn;h.extend(t);var n=t.prototype;Object.defineProperties(n,{midi:{set:function(g){"number"===typeof g&&(this._.midi=g)},get:function(){return this._.midi}},a4:{set:function(g){"number"===typeof g&&(this._.a4=g,this._.prev=null)},get:function(){return this._.a4}}});n.bang=function(){this._.prev=null;this._.emit("bang");return this};n.at=function(g){return this._.a4*Math.pow(2,(g-69)/
12)};n.process=function(g){var e=this._;if(this.tickID!==g){this.tickID=g;g=this.cells[0];var a=this.nodes.length,d=g.length;if(e.ar&&a){h.inputSignalAR(this);var b=e.a4;for(a=0;a<d;++a)g[a]=b*Math.pow(2,(g[a]-69)/12);e.value=g[d-1];h.outputSignalAR(this)}else d=a?h.inputSignalKR(this):e.midi,e.prev!==d&&(e.prev=d,e.value=e.a4*Math.pow(2,(d-69)/12)),g[0]=e.value,h.outputSignalKR(this)}return this};h.register("midicps",t)})(timbre);
(function(u){function t(g){u.Object.call(this,1,g);g=this._;g.midi=0;g.value=0;g.prev=null;g.range=12;g.ar=!1}var h=u.fn;h.extend(t);var n=t.prototype;Object.defineProperties(n,{midi:{set:function(g){"number"===typeof g&&(this._.midi=g)},get:function(){return this._.midi}},range:{set:function(g){"number"===typeof g&&0<g&&(this._.range=g)},get:function(){return this._.range}}});n.bang=function(){this._.prev=null;this._.emit("bang");return this};n.at=function(g){return Math.pow(2,g/this._.range)};n.process=
function(g){var e=this.cells[0],a=this._;if(this.tickID!==g){this.tickID=g;var d=this.nodes.length;g=e.length;if(a.ar&&d){h.inputSignalAR(this);var b=a.range;for(d=0;d<g;++d)e[d]=Math.pow(2,e[d]/b);a.value=e[g-1];h.outputSignalAR(this)}else for(d=this.nodes.length?h.inputSignalKR(this):a.midi,a.prev!==d&&(a.prev=d,a.value=Math.pow(2,d/a.range)),a=a.value*a.mul+a.add,d=0;d<g;++d)e[d]=a}return this};h.register("midiratio",t)})(timbre);
(function(u){function t(n){u.Object.call(this,1,n)}var h=u.fn;h.extend(t);t.prototype.process=function(n){var g=this.cells[0],e=this._;if(this.tickID!==n){this.tickID=n;var a=this.nodes,d=a.length,b,c=g.length;if(e.ar){if(0<a.length){var f=a[0].process(n).cells[0];g.set(f);for(e=1;e<d;++e)for(f=a[e].process(n).cells[0],b=0;b<c;++b){var m=f[b];g[b]>m&&(g[b]=m)}}else for(b=0;b<c;++b)g[b]=0;h.outputSignalAR(this)}else{if(0<a.length)for(f=a[0].process(n).cells[0][0],e=1;e<d;++e)m=a[e].process(n).cells[0][0],
f>m&&(f=m);else f=0;g[0]=f;h.outputSignalKR(this)}}return this};h.register("min",t)})(timbre);
(function(u){function t(a){u.Object.call(this,0,a);h.timer(this);h.fixKR(this);a=this._;a.tracks=[];a.onended=h.make_onended(this);a.currentTime=0;this.on("start",n)}var h=u.fn;h.extend(t);var n=function(){var a=this,d=this._,b=d.mml;"string"===typeof b&&(b=[b]);d.tracks=b.map(function(c,f){return new e(a,f,c)});d.currentTime=0;this.playbackState=h.PLAYING_STATE};Object.defineProperty(n,"unremoved",{value:!0,writable:!1});var g=t.prototype;Object.defineProperties(g,{mml:{set:function(a){var d=this._;
if("string"===typeof a||Array.isArray(a))d.mml=a},get:function(){return this._.mml}},currentTime:{get:function(){return this._.currentTime}}});g.on=g.addListener=function(a,d){"mml"===a&&(a="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."));this._.events.on(a,d);return this};g.once=function(a,d){"mml"===a&&(a="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."));this._.events.once(a,d);return this};
g.off=g.removeListener=function(a,d){"mml"===a&&(a="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."));this._.events.off(a,d);return this};g.removeAllListeners=function(a){"mml"===a&&(console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."),a="data");this._.events.removeAllListeners(a);return this};g.listeners=function(a){"mml"===a&&(console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."),
a="data");return this._.events.listeners(a)};g.process=function(a){var d=this._;if(this.tickID!==a){this.tickID=a;var b,c=d.tracks;a=0;for(b=c.length;a<b;++a)c[a].process();for(;a--;)c[a].ended&&c.splice(a,1);0===c.length&&h.nextTick(d.onended);d.currentTime+=h.currentTimeIncr}return this};h.register("mml",t);var e=function(){function a(f,m,k){var l=this._={};l.sequencer=f;l.trackNum=m;l.commands=b(k);l.status={t:120,l:4,o:4,v:12,q:6,dot:0,tie:!1};l.index=0;l.queue=[];l.currentTime=0;l.queueTime=
0;l.segnoIndex=-1;l.loopStack=[];l.prevNote=0;l.remain=Infinity;this.ended=!1;d(this)}a.prototype.process=function(){var f=this._,m=f.sequencer,k=f.trackNum,l=f.queue,r=!1;if(l.length)for(;l[0][0]<=f.currentTime;){var w=f.queue.shift();switch(w[1]){case 1:var z,C=m,F=k,D=w[2],E=w[3],H=C.nodes;var L=0;for(z=H.length;L<z;++L){var K=H[L];K.noteOn?K.noteOn(D,E):K.bang()}C._.emit("data","noteOn",{trackNum:F,noteNum:D,velocity:E});f.remain=w[4];d(this);break;case 2:z=m;L=k;K=w[2];D=w[3];E=z.nodes;C=0;for(w=
E.length;C<w;++C)F=E[C],F.noteOff?F.noteOff(K,D):F.release&&F.release();z._.emit("data","noteOff",{trackNum:L,noteNum:K,velocity:D});break;case 3:m._.emit("data","command",{command:w[2]});break;case 0:r=!0}if(0===l.length)break}f.remain-=h.currentTimeIncr;r&&(this.ended=!0);f.currentTime+=h.currentTimeIncr};var d=function(f){f=f._;var m=f.commands,k=f.queue,l=f.index,r=f.status,w=f.queueTime,z=f.loopStack,C;var F=[];a:for(;;){if(m.length<=l)if(0<=f.segnoIndex)l=f.segnoIndex;else break;var D=m[l++];
switch(D.name){case "@":k.push([w,3,D.val]);break;case "n":var E=r.t||120;if(null!==D.len){var H=D.len;var L=D.dot||0}else H=r.l,L=D.dot||r.dot;E=60/E*(4/H)*1E3;E*=2-1/Math.pow(2,L);L=r.v<<3;if(r.tie){for(D=k.length;D--;)if(k[D][2]){k.splice(D,1);break}D=f.prevNote}else D=f.prevNote=D.val+12*(r.o+1),k.push([w,1,D,L,E]);if(0<H){H=r.q/8;if(1>H)for(H=w+E*H,k.push([H,2,D,L]),D=0,C=F.length;D<C;++D)k.push([H,2,F[D],L]);F=[];w+=E;if(!r.tie)break a}else F.push(D);r.tie=!1;break;case "r":E=r.t||120;null!==
D.len?(H=D.len,L=D.dot||0):(H=r.l,L=D.dot||r.dot);0<H&&(E=60/E*(4/H)*1E3,E*=2-1/Math.pow(2,L),w+=E);break;case "l":r.l=D.val;r.dot=D.dot;break;case "o":r.o=D.val;break;case "<":9>r.o&&(r.o+=1);break;case ">":0<r.o&&--r.o;break;case "v":r.v=D.val;break;case "(":15>r.v&&(r.v+=1);break;case ")":0<r.v&&--r.v;break;case "q":r.q=D.val;break;case "&":r.tie=!0;break;case "$":f.segnoIndex=l;break;case "[":z.push([l,null,null]);break;case "|":(E=z[z.length-1])&&1===E[1]&&(z.pop(),l=E[2]);break;case "]":if(E=
z[z.length-1])null===E[1]&&(E[1]=D.count,E[2]=l),--E[1],0===E[1]?z.pop():l=E[0];break;case "t":r.t=null===D.val?120:D.val;break;case "EOF":k.push([w,0])}}f.index=l;f.queueTime=w},b=function(f){var m,k,l,r,w=Array(f.length),z=[];var C=0;for(l=c.length;C<l;++C){var F=c[C];for(m=F.re;k=m.exec(f);){if(!w[k.index]){var D=0;for(r=k[0].length;D<r;++D)w[k.index+D]=!0;if(D=F.func?F.func(k):{name:k[0]})D.index=k.index,D.origin=k[0],z.push(D)}for(;m.lastIndex<f.length&&w[m.lastIndex];)++m.lastIndex}}z.sort(function(E,
H){return E.index-H.index});z.push({name:"EOF"});return z},c=[{re:/@(\d*)/g,func:function(f){return{name:"@",val:f[1]||null}}},{re:/([cdefgab])([\-+]?)(\d*)(\.*)/g,func:function(f){return{name:"n",val:{c:0,d:2,e:4,f:5,g:7,a:9,b:11}[f[1]]+({"-":-1,"+":1}[f[2]]||0),len:""===f[3]?null:Math.min(f[3]|0,64),dot:f[4].length}}},{re:/r(\d*)(\.*)/g,func:function(f){return{name:"r",len:""===f[1]?null:Math.max(1,Math.min(f[1]|0,64)),dot:f[2].length}}},{re:/&/g},{re:/l(\d*)(\.*)/g,func:function(f){return{name:"l",
val:""===f[1]?4:Math.min(f[1]|0,64),dot:f[2].length}}},{re:/o([0-9])/g,func:function(f){return{name:"o",val:""===f[1]?4:f[1]|0}}},{re:/[<>]/g},{re:/v(\d*)/g,func:function(f){return{name:"v",val:""===f[1]?12:Math.min(f[1]|0,15)}}},{re:/[()]/g},{re:/q([0-8])/g,func:function(f){return{name:"q",val:""===f[1]?6:Math.min(f[1]|0,8)}}},{re:/\[/g},{re:/\|/g},{re:/\](\d*)/g,func:function(f){return{name:"]",count:f[1]|0||2}}},{re:/t(\d*)/g,func:function(f){return{name:"t",val:""===f[1]?null:Math.max(5,Math.min(f[1]|
0,300))}}},{re:/\$/g}];return a}()})(timbre);(function(u){function t(n){u.Object.call(this,1,n)}var h=u.fn;h.extend(t);t.prototype.process=function(n){var g=this._;this.tickID!==n&&(this.tickID=n,g.ar?(h.inputSignalAR(this),h.outputSignalAR(this)):(this.cells[0][0]=h.inputSignalKR(this),h.outputSignalKR(this)));return this};h.register("mono",t)})(timbre);
(function(u){function t(n){u.Object.call(this,2,n)}var h=u.fn;h.extend(t);t.prototype.process=function(n){var g=this._;if(this.tickID!==n){this.tickID=n;var e=this.nodes,a=this.cells[0],d=this.cells[1],b=this.cells[2],c=e.length,f=a.length;if(g.ar){if(0<e.length){e[0].process(n);var m=e[0].cells[1];var k=e[0].cells[2];d.set(m);b.set(k);for(g=1;g<c;++g)for(e[g].process(n),m=e[g].cells[1],k=e[g].cells[2],a=0;a<f;++a)d[a]*=m[a],b[a]*=k[a]}else for(a=0;a<f;++a)d[a]=b[a]=0;h.outputSignalAR(this)}else{if(0<
e.length)for(d=e[0].process(n).cells[0][0],g=1;g<c;++g)d*=e[g].process(n).cells[0][0];else d=0;a[0]=d;h.outputSignalKR(this)}}return this};h.register("*",t)})(timbre);
(function(u){function t(g){u.Object.call(this,1,g);g=this._;g.defaultValue=0;g.index=0;g.dict={};g.ar=!1}var h=u.fn;h.extend(t);var n=t.prototype;Object.defineProperties(n,{dict:{set:function(g){if("object"===typeof g)this._.dict=g;else if("function"===typeof g){for(var e={},a=0;128>a;++a)e[a]=g(a);this._.dict=e}},get:function(){return this._.dict}},defaultValue:{set:function(g){"number"===typeof g&&(this._.defaultValue=g)},get:function(){return this._.defaultValue}},index:{set:function(g){"number"===
typeof g&&(this._.index=g)},get:function(){return this._.index}}});n.at=function(g){var e=this._;return(e.dict[g|0]||e.defaultValue)*e.mul+e.add};n.clear=function(){this._.dict={};return this};n.process=function(g){var e=this.cells[0],a=this._;if(this.tickID!==g){this.tickID=g;var d=this.nodes.length;var b=a.dict;var c=a.defaultValue,f=a.mul,m=a.add;g=e.length;if(a.ar&&d){h.inputSignalAR(this);for(a=0;a<g;++a)d=e[a],d=0>d?d-.5|0:d+.5|0,e[a]=(b[d]||c)*f+m;h.outputSignalAR(this)}else for(d=this.nodes.length?
h.inputSignalKR(this):a.index,b=(b[0>d?d-.5|0:d+.5|0]||c)*f+m,a=0;a<g;++a)e[a]=b}return this};h.register("ndict",t)})(timbre);(function(u){function t(n){u.Object.call(this,1,n)}var h=u.fn;h.extend(t);t.prototype.process=function(n){var g=this.cells[0],e=this._;if(this.tickID!==n){this.tickID=n;n=e.mul;var a=e.add,d;if(e.ar)for(e=0,d=g.length;e<d;++e)g[e]=(2*Math.random()-1)*n+a;else for(n=(2*Math.random()+1)*n+a,e=0,d=g.length;e<d;++e)g[e]=n}return this};h.register("noise",t)})(timbre);
(function(u){function t(b){u.Object.call(this,2,b);b=this._;b.freq=u(440);b.phase=u(0);b.osc=new g(b.samplerate);b.tmp=new h.SignalArray(b.cellsize);b.osc.step=b.cellsize;this.once("init",e)}var h=u.fn,n=u.timevalue,g=u.modules.Oscillator;h.extend(t);var e=function(){var b=this._;this.wave||(this.wave="sin");b.plotData=b.osc.wave;b.plotLineWidth=2;b.plotCyclic=!0;b.plotBefore=d},a=t.prototype;Object.defineProperties(a,{wave:{set:function(b){this._.osc.setWave(b)},get:function(){return this._.osc.wave}},
freq:{set:function(b){"string"===typeof b&&(b=n(b),b=0>=b?0:1E3/b);this._.freq=u(b)},get:function(){return this._.freq}},phase:{set:function(b){this._.phase=u(b);this._.osc.feedback=!1},get:function(){return this._.phase}},fb:{set:function(b){this._.phase=u(b);this._.osc.feedback=!0},get:function(){return this._.phase}}});a.clone=function(){var b=h.clone(this);b._.osc=this._.osc.clone();b._.freq=this._.freq;b._.phase=this._.phase;return b};a.bang=function(){this._.osc.reset();this._.emit("bang");
return this};a.process=function(b){var c=this._;if(this.tickID!==b){this.tickID=b;var f=this.cells[1],m=this.cells[2],k,l=c.cellsize;if(this.nodes.length)h.inputSignalAR(this);else for(k=0;k<l;++k)f[k]=m[k]=1;k=c.osc;var r=c.freq.process(b).cells[0],w=c.phase.process(b).cells[0];k.frequency=r[0];k.phase=w[0];if(c.ar)for(b=c.tmp,c.freq.isAr?c.phase.isAr?k.processWithFreqAndPhaseArray(b,r,w):k.processWithFreqArray(b,r):c.phase.isAr?k.processWithPhaseArray(b,w):k.process(b),k=0;k<l;++k)f[k]*=b[k],m[k]*=
b[k];else for(c=k.next(),k=0;k<l;++k)f[k]*=c,m[k]*=c;h.outputSignalAR(this)}return this};var d;"browser"===u.envtype&&(d=function(b,c,f,m,k){k=(k>>1)+.5;b.strokeStyle="#ccc";b.lineWidth=1;b.beginPath();b.moveTo(c,k+f);b.lineTo(c+m,k+f);b.stroke()});h.register("osc",t);h.register("sin",function(b){return(new t(b)).set("wave","sin")});h.register("cos",function(b){return(new t(b)).set("wave","cos")});h.register("pulse",function(b){return(new t(b)).set("wave","pulse")});h.register("tri",function(b){return(new t(b)).set("wave",
"tri")});h.register("saw",function(b){return(new t(b)).set("wave","saw")});h.register("fami",function(b){return(new t(b)).set("wave","fami")});h.register("konami",function(b){return(new t(b)).set("wave","konami")});h.register("+sin",function(b){return(new t(b)).set("wave","+sin").kr()});h.register("+pulse",function(b){return(new t(b)).set("wave","+pulse").kr()});h.register("+tri",function(b){return(new t(b)).set("wave","+tri").kr()});h.register("+saw",function(b){return(new t(b)).set("wave","+saw").kr()});
h.alias("square","pulse")})(timbre);
(function(u){function t(g){u.Object.call(this,2,g);h.fixAR(this);g=this._;g.pos=u(0);g.panL=.5;g.panR=.5}var h=u.fn;h.extend(t);var n=t.prototype;Object.defineProperties(n,{pos:{set:function(g){this._.pos=u(g)},get:function(){return this._.pos}}});n.process=function(g){var e=this._;if(this.tickID!==g){this.tickID=g;var a=e.pos.process(g).cells[0][0];e.prevPos!==a&&(e.panL=1-a,e.panR=e.prevPos=a);var d=this.nodes;a=this.cells[1];var b=this.cells[2],c,f=d.length,m,k=a.length;if(f){var l=d[0].process(g).cells[0];
for(m=0;m<k;++m)a[m]=b[m]=l[m];for(c=1;c<f;++c)for(l=d[c].process(g).cells[0],m=0;m<k;++m)a[m]=b[m]+=l[m];g=e.panL;e=e.panR;for(m=0;m<k;++m)a[m]*=g,b[m]*=e}else a.set(h.emptycell),b.set(h.emptycell);h.outputSignalAR(this)}return this};h.register("pan",t)})(timbre);
(function(u){function t(f){u.Object.call(this,2,f);f=this._;f.value=0;f.env=new e(f.samplerate);f.env.step=f.cellsize;f.curve="lin";f.counter=0;f.ar=!1;f.onended=a(this);this.on("ar",d)}var h=u.fn,n=u.timevalue,g=u.modules.Envelope,e=u.modules.EnvelopeValue;h.extend(t);var a=function(f,m){return function(){if("number"===typeof m)for(var k=f.cells[0],l=f.cells[1],r=f.cells[2],w=f._.env.value,z=0,C=l.length;z<C;++z)k[0]=l[z]=r[z]=w;f._.emit("ended")}},d=function(f){this._.env.step=f?1:this._.cellsize},
b=t.prototype;Object.defineProperties(b,{value:{set:function(f){"number"===typeof f&&(this._.env.value=f)},get:function(){return this._.env.value}}});b.to=function(f,m,k){var l=this._,r=l.env;"string"===typeof m?m=n(m):"undefined"===typeof m&&(m=0);if("undefined"===typeof k)l.counter=r.setNext(f,m,g.CurveTypeLin),l.curve="lin";else{var w=g.CurveTypeDict[k];l.counter="undefined"===typeof w?r.setNext(f,m,g.CurveTypeCurve,k):r.setNext(f,m,w);l.curve=k}l.plotFlush=!0;return this};b.setAt=function(f,m){var k=
this._;this.to(k.env.value,m,"set");k.atValue=f;return this};b.linTo=function(f,m){return this.to(f,m,"lin")};b.expTo=function(f,m){return this.to(f,m,"exp")};b.sinTo=function(f,m){return this.to(f,m,"sin")};b.welTo=function(f,m){return this.to(f,m,"wel")};b.sqrTo=function(f,m){return this.to(f,m,"sqr")};b.cubTo=function(f,m){return this.to(f,m,"cub")};b.cancel=function(){var f=this._;f.counter=f.env.setNext(f.env.value,0,g.CurveTypeSet);return this};b.process=function(f){var m=this._;if(this.tickID!==
f){this.tickID=f;f=this.cells[1];var k=this.cells[2],l,r=m.cellsize,w=m.env,z=m.counter;if(this.nodes.length)h.inputSignalAR(this);else for(l=0;l<r;++l)f[l]=k[l]=1;0>=z&&("set"===m.curve?w.setNext(m.atValue,0,g.CurveTypeSet):w.setNext(w.value,0,g.CurveTypeSet),h.nextTick(m.onended),m.counter=Infinity);if(m.ar){for(l=0;l<r;++l){var C=w.next();f[l]*=C;k[l]*=C}m.counter-=m.cellsize}else{C=w.next();for(l=0;l<r;++l)f[l]*=C,k[l]*=C;--m.counter}h.outputSignalAR(this);m.value=C}return this};var c=u.Object.prototype.plot;
b.plot=function(f){var m=this._;if(m.plotFlush){var k=new e(128),l=new Float32Array(128),r;if("set"===m.curve){var w=100;for(r=l.length;w<r;++w)l[w]=1}else for(w=g.CurveTypeDict[m.curve],"undefined"===typeof w?k.setNext(1,1E3,g.CurveTypeCurve,m.curve):k.setNext(1,1E3,w),w=0,r=l.length;w<r;++w)l[w]=k.next();m.plotData=l;m.plotRange=[0,1];m.plotFlush=null}return c.call(this,f)};h.register("param",t)})(timbre);
(function(u){function t(e){u.Object.call(this,2,e);h.fixAR(this);e=this._;e.freq=u("sin",{freq:1,add:1E3,mul:250}).kr();e.Q=u(1);e.allpass=[];this.steps=2}var h=u.fn,n=u.modules.Biquad;h.extend(t);var g=t.prototype;Object.defineProperties(g,{freq:{set:function(e){this._.freq=e},get:function(){return this._.freq}},Q:{set:function(e){this._.Q=u(e)},get:function(){return this._.Q}},steps:{set:function(e){if("number"===typeof e){e|=0;if(2===e||4===e||8===e||12===e){var a=this._.allpass;if(a.length<e)for(var d=
a.length;d<e;++d)a[d]=new n(this._.samplerate),a[d].setType("allpass")}this._.steps=e}},get:function(){return this._.steps}}});g.process=function(e){var a=this._;if(this.tickID!==e){this.tickID=e;h.inputSignalAR(this);if(!a.bypassed){var d=this.cells[1],b=this.cells[2],c=a.freq.process(e).cells[0][0];e=a.Q.process(e).cells[0][0];var f=a.steps,m;for(m=0;m<f;m+=2)a.allpass[m].setParams(c,e,0),a.allpass[m].process(d,b),a.allpass[m+1].setParams(c,e,0),a.allpass[m+1].process(d,b)}h.outputSignalAR(this)}return this};
h.register("phaser",t)})(timbre);
(function(u){function t(n){u.Object.call(this,1,n);h.fixAR(this);n=new Uint8Array(5);for(var g=0;5>g;++g)n[g]=(1073741824*Math.random()|0)%25;this._.whites=n;this._.key=0}var h=u.fn;h.extend(t);t.prototype.process=function(n){var g=this.cells[0],e=this._;if(this.tickID!==n){this.tickID=n;var a,d=e.key,b=e.whites,c=e.mul,f=e.add,m;n=0;for(a=g.length;n<a;++n){var k=d++;31<d&&(d=0);var l=k^d;for(k=m=0;5>k;++k)l&1<<k&&(b[k]=(1073741824*Math.random()|0)%25),m+=b[k];g[n]=(.01666666*m-1)*c+f}e.key=d}return this};
h.register("pink",t)})(timbre);
(function(u){function t(g){u.Object.call(this,1,g);this._.freq=440;this._.buffer=null;this._.index=0}var h=u.fn;h.extend(t);var n=t.prototype;Object.defineProperties(n,{freq:{set:function(g){"number"===typeof g&&(0>g&&(g=0),this._.freq=g)},get:function(){return this._.freq}}});n.bang=function(){for(var g=this._,e=g.samplerate/g.freq+.5|0,a=g.buffer=new h.SignalArray(e),d=0;d<e;++d)a[d]=2*Math.random()-1;g.index=0;g.emit("bang");return this};n.process=function(g){var e=this.cells[0],a=this._;if(this.tickID!==
g&&(this.tickID=g,g=a.buffer)){var d=g.length,b=a.index,c=a.mul,f=a.add,m,k=e.length;for(m=0;m<k;++m){var l=b;var r=g[b++];b>=d&&(b=0);r=.5*(r+g[b]);g[l]=r;e[m]=r*c+f}a.index=b}return this};h.register("pluck",t)})(timbre);
(function(u){function t(a){u.Object.call(this,1,a);h.listener(this);h.fixAR(this);a=this._;a.timeout=5E3;a.status=0;a.writeIndex=0;a.writeIndexIncr=1;a.currentTime=0;a.currentTimeIncr=1E3/a.samplerate;a.onended=g(this)}var h=u.fn,n=u.timevalue;h.extend(t);var g=function(a){return function(){var d=a._,b=new h.SignalArray(d.buffer.subarray(0,d.writeIndex|0));d.status=0;d.writeIndex=0;d.currentTime=0;d.emit("ended",{buffer:b,samplerate:d.samplerate})}},e=t.prototype;Object.defineProperties(e,{timeout:{set:function(a){"string"===
typeof a&&(a=n(a));"number"===typeof a&&0<a&&(this._.timeout=a)},get:function(){return this._.timeout}},samplerate:{set:function(a){"number"===typeof a&&0<a&&a<=this._.samplerate&&(this._.samplerate=a)},get:function(){return this._.samplerate}},currentTime:{get:function(){return this._.currentTime}}});e.start=function(){var a=this._;if(0===a.status){var d=.01*a.timeout*a.samplerate|0;if(!a.buffer||a.buffer.length<d)a.buffer=new h.SignalArray(d);a.writeIndex=0;a.writeIndexIncr=a.samplerate/u.samplerate;
a.currentTime=0;a.status=1;a.emit("start");this.listen()}return this};e.stop=function(){var a=this._;1===a.status&&(a.status=0,a.emit("stop"),h.nextTick(a.onended),this.unlisten());return this};e.bang=function(){0===this._.status?this.srart():1===this._.status&&this.stop();this._.emit("bang");return this};e.process=function(a){var d=this._,b=this.cells[0];if(this.tickID!==a){this.tickID=a;h.inputSignalAR(this);if(1===d.status){var c=b.length,f=d.buffer,m=d.timeout,k=d.writeIndex,l=d.writeIndexIncr,
r=d.currentTime,w=d.currentTimeIncr;for(a=0;a<c;++a)f[k|0]=b[a],k+=l,r+=w,m<=r&&h.nextTick(d.onended);d.writeIndex=k;d.currentTime=r}h.outputSignalAR(this)}return this};h.register("record",t);h.alias("rec","record")})(timbre);
(function(u){function t(e){u.Object.call(this,2,e);h.fixAR(this);this._.reverb=new n(this._.samplerate,this._.cellsize)}var h=u.fn,n=u.modules.Reverb;h.extend(t);var g=t.prototype;Object.defineProperties(g,{room:{set:function(e){"number"===typeof e&&this._.reverb.setRoomSize(1<e?1:0>e?0:e)},get:function(){return this._.reverb.roomsize}},damp:{set:function(e){"number"===typeof e&&this._.reverb.setDamp(1<e?1:0>e?0:e)},get:function(){return this._.reverb.damp}},mix:{set:function(e){"number"===typeof e&&
(this._.reverb.wet=1<e?1:0>e?0:e)},get:function(){return this._.reverb.wet}}});g.process=function(e){var a=this._;this.tickID!==e&&(this.tickID=e,h.inputSignalAR(this),a.bypassed||a.reverb.process(this.cells[1],this.cells[2]),h.outputSignalAR(this));return this};h.register("reverb",t)})(timbre);
(function(u){function t(e){u.Object.call(this,0,e);h.timer(this);h.fixKR(this);e=this._;e.queue=[];e.currentTime=0;e.maxRemain=1E3}var h=u.fn,n=u.timevalue;h.extend(t);var g=t.prototype;Object.defineProperties(g,{queue:{get:function(){return this._.queue}},remain:{get:function(){return this._.queue.length}},maxRemain:{set:function(e){"number"===typeof e&&0<e&&(this._.maxRemain=e)},get:function(){return this._.maxRemain}},isEmpty:{get:function(){return 0===this._.queue.length}},currentTime:{get:function(){return this._.currentTime}}});
g.sched=function(e,a,d){"string"===typeof e&&(e=n(e));"number"===typeof e&&this.schedAbs(this._.currentTime+e,a,d);return this};g.schedAbs=function(e,a,d){"string"===typeof e&&(e=n(e));if("number"===typeof e){var b=this._,c=b.queue;if(c.length>=b.maxRemain)return this;for(b=c.length;b--&&!(c[b][0]<e););c.splice(b+1,0,[e,u(a),d])}return this};g.advance=function(e){"string"===typeof e&&(e=n(e));"number"===typeof e&&(this._.currentTime+=e);return this};g.clear=function(){this._.queue.splice(0);return this};
g.process=function(e){var a=this._;if(this.tickID!==e){this.tickID=e;var d=null;e=a.queue;if(e.length)for(;e[0][0]<a.currentTime;)if(d=a.queue.shift(),d[1].bang(d[2]),d="sched",0===e.length){d="empty";break}a.currentTime+=h.currentTimeIncr;d&&a.emit(d)}return this};h.register("schedule",t);h.alias("sched","schedule")})(timbre);
(function(u){function t(d){u.Object.call(this,2,d);h.listener(this);h.fixAR(this);d=this._;d.samples=0;d.writeIndex=0;d.plotFlush=!0;this.once("init",g)}var h=u.fn,n=u.timevalue;h.extend(t);var g=function(){this._.buffer||(this.size=1024);this._.interval||(this.interval=1E3)},e=t.prototype;Object.defineProperties(e,{size:{set:function(d){var b=this._;b.buffer||"number"!==typeof d||(b.buffer=new h.SignalArray(64>d?64:2048<d?2048:d),b.reservedinterval&&(this.interval=b.reservedinterval,b.reservedinterval=
null))},get:function(){return this._.buffer.length}},interval:{set:function(d){var b=this._;"string"===typeof d&&(d=n(d));"number"===typeof d&&0<d&&(b.buffer?(b.interval=d,b.samplesIncr=.001*d*b.samplerate/b.buffer.length,1>b.samplesIncr&&(b.samplesIncr=1)):b.reservedinterval=d)},get:function(){return this._.interval}},buffer:{get:function(){return this._.buffer}}});e.bang=function(){for(var d=this._,b=d.buffer,c=0,f=b.length;c<f;++c)b[c]=0;d.samples=0;d.writeIndex=0;this._.emit("bang");return this};
e.process=function(d){var b=this._;if(this.tickID!==d){this.tickID=d;h.inputSignalAR(this);h.outputSignalAR(this);d=this.cells[0];var c,f=b.cellsize,m=b.samples,k=b.samplesIncr,l=b.buffer,r=b.writeIndex,w=!1,z=l.length;for(c=0;c<f;++c)0>=m&&(l[r++]=d[c],r>=z&&(r=0),w=b.plotFlush=!0,m+=k),--m;b.samples=m;b.writeIndex=r;w&&this._.emit("data")}return this};var a=u.Object.prototype.plot;e.plot=function(d){var b=this._;if(b.plotFlush){for(var c=b.buffer,f=c.length-1,m=new Float32Array(c.length),k=b.writeIndex,
l=0,r=c.length;l<r;l++)m[l]=c[++k&f];b.plotData=m;b.plotFlush=null}return a.call(this,d)};h.register("scope",t)})(timbre);
(function(u){function t(d){u.Object.call(this,2,d);g.fixAR(this);d=this._;d.numberOfInputs=0;d.numberOfOutputs=0;d.bufferSize=0;d.bufferMask=0;d.duration=0;d.inputBufferL=null;d.inputBufferR=null;d.outputBufferL=null;d.outputBufferR=null;d.onaudioprocess=null;d.index=0;this.once("init",e)}function h(d,b){this.samplerate=d._.samplerate;this.length=d._.bufferSize;this.duration=d._.duration;this.numberOfChannels=b.length;this.getChannelData=function(c){return b[c]}}function n(d){var b=d._;this.node=
d;this.playbackTime=u.currentTime;this.inputBuffer=2===b.numberOfInputs?new h(d,[b.inputBufferL,b.inputBufferR]):new h(d,[b.inputBufferL]);this.outputBuffer=2===b.numberOfOutputs?new h(d,[b.outputBufferL,b.outputBufferR]):new h(d,[b.outputBufferL])}var g=u.fn;g.extend(t);var e=function(){var d=this._;0===d.numberOfInputs&&(this.numberOfInputs=1);0===d.numberOfOutputs&&(this.numberOfOutputs=1);0===d.bufferSize&&(this.bufferSize=1024)},a=t.prototype;Object.defineProperties(a,{numberOfInputs:{set:function(d){var b=
this._;0===b.numberOfInputs&&(b.numberOfInputs=2===d?2:1)},get:function(){return this._.numberOfInputs}},numberOfOutputs:{set:function(d){var b=this._;0===b.numberOfOutputs&&(b.numberOfOutputs=2===d?2:1)},get:function(){return this._.numberOfOutputs}},bufferSize:{set:function(d){var b=this._;0===b.bufferSize&&-1!==[256,512,1024,2048,4096,8192,16384].indexOf(d)&&(b.bufferSize=d,b.bufferMask=d-1,b.duration=d/b.samplerate,b.inputBufferL=new g.SignalArray(d),b.inputBufferR=new g.SignalArray(d),b.outputBufferL=
new g.SignalArray(d),b.outputBufferR=new g.SignalArray(d))},get:function(){return this._.bufferSize}},onaudioprocess:{set:function(d){"function"===typeof d&&(this._.onaudioprocess=d)},get:function(){return this._.onaudioprocess}}});a.process=function(d){var b=this._;if(this.tickID!==d){this.tickID=d;d=b.cellsize;var c=b.bufferMask,f=b.index,m=f+d,k=this.cells[1],l=this.cells[2];g.inputSignalAR(this);if(2===b.numberOfInputs)b.inputBufferL.set(k,f),b.inputBufferR.set(l,f);else{var r=b.inputBufferL;
for(var w=0;w<d;w++)r[f+w]=.5*(k[w]+l[w])}k.set(b.outputBufferL.subarray(f,m));l.set(b.outputBufferR.subarray(f,m));b.index=m&c;0===b.index&&b.onaudioprocess&&(b.onaudioprocess(new n(this)),1===b.numberOfOutputs&&b.outputBufferR.set(b.outputBufferL));g.outputSignalAR(this)}return this};g.register("script",t)})(timbre);
(function(u){function t(g){u.Object.call(this,2,g);this._.selected=0;this._.background=!1}var h=u.fn;h.extend(t);var n=t.prototype;Object.defineProperties(n,{selected:{set:function(g){"number"===typeof g&&(this._.selected=g,this.cells[1].set(h.emptycell),this.cells[2].set(h.emptycell))},get:function(){return this._.selected}},background:{set:function(g){this._.background=!!g},get:function(){return this._.background}}});n.process=function(g){var e=this._;if(this.tickID!==g){this.tickID=g;var a=this.nodes,
d,b=a.length;if(e.background)for(d=0;d<b;++d)a[d].process(g);if(a=a[e.selected])e.background||a.process(g),this.cells[1].set(a.cells[1]),this.cells[2].set(a.cells[2]);h.outputSignalAR(this)}return this};h.register("selector",t)})(timbre);
(function(u){function t(b){u.Object.call(this,2,b);h.listener(this);h.fixAR(this);b=this._;b.status=0;b.samples=0;b.samplesIncr=0;b.writeIndex=0;b.plotFlush=!0;b.plotRange=[0,32];b.plotBarStyle=!0;this.once("init",e)}var h=u.fn,n=u.timevalue,g=u.modules.FFT;h.extend(t);var e=function(){var b=this._;b.fft||(this.size=512);b.interval||(this.interval=500)},a=t.prototype;Object.defineProperties(a,{size:{set:function(b){var c=this._;c.fft||"number"!==typeof b||(c.fft=new g(256>b?256:2048<b?2048:b),c.buffer=
new h.SignalArray(c.fft.length),c.freqs=new h.SignalArray(c.fft.length>>1),c.reservedwindow&&(c.fft.setWindow(c.reservedwindow),c.reservedwindow=null),c.reservedinterval&&(this.interval=c.reservedinterval,c.reservedinterval=null))},get:function(){return this._.buffer.length}},window:{set:function(b){this._.fft.setWindow(b)},get:function(){return this._.fft.windowName}},interval:{set:function(b){var c=this._;"string"===typeof b&&(b=n(b));"number"===typeof b&&0<b&&(c.buffer?(c.interval=b,c.samplesIncr=
.001*b*c.samplerate,c.samplesIncr<c.buffer.length&&(c.samplesIncr=c.buffer.length,c.interval=1E3*c.samplesIncr/c.samplerate)):c.reservedinterval=b)},get:function(){return this._.interval}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}},real:{get:function(){return this._.fft.real}},imag:{get:function(){return this._.fft.imag}}});a.bang=function(){this._.samples=0;this._.writeIndex=0;this._.emit("bang");return this};a.process=function(b){var c=this._;if(this.tickID!==b){this.tickID=
b;h.inputSignalAR(this);h.outputSignalAR(this);b=this.cells[0];var f,m=b.length,k=c.status,l=c.samples,r=c.samplesIncr,w=c.writeIndex,z=c.buffer,C=z.length;for(f=0;f<m;++f){0>=l&&0===k&&(k=1,w=0,l+=r);if(1===k&&(z[w++]=b[f],C<=w)){c.fft.forward(z);var F=c.plotFlush=!0;k=0}--l}c.samples=l;c.status=k;c.writeIndex=w;F&&this._.emit("data")}return this};var d=u.Object.prototype.plot;a.plot=function(b){this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null);return d.call(this,b)};h.register("spectrum",
t)})(timbre);
(function(u){function t(n){u.Object.call(this,2,n);this._.ar=!1}var h=u.fn;h.extend(t);t.prototype.process=function(n){var g=this._;if(this.tickID!==n){this.tickID=n;var e=this.nodes,a=this.cells[0],d=this.cells[1],b=this.cells[2],c,f=e.length,m=a.length;if(g.ar){if(0<e.length){e[0].process(n);g=e[0].cells[1];var k=e[0].cells[2];d.set(g);b.set(k);for(c=1;c<f;++c)for(e[c].process(n),g=e[c].cells[1],k=e[c].cells[2],a=0;a<m;++a)d[a]-=g[a],b[a]-=k[a]}else for(a=0;a<m;++a)d[a]=b[c]=0;h.outputSignalAR(this)}else{if(0<e.length)for(d=
e[0].process(n).cells[0][0],c=1;c<f;++c)d-=e[c].process(n).cells[0][0];else d=0;a[0]=d;h.outputSignalKR(this)}}return this};h.register("-",t)})(timbre);
(function(u){function t(c){u.Object.call(this,2,c);h.fixAR(this);c=this._;this.playbackState=h.FINISHED_STATE;c.poly=4;c.genList=[];c.genDict={};c.synthdef=null;c.remGen=e(this);c.onended=h.make_onended(this)}var h=u.fn;h.extend(t);var n=t.prototype;Object.defineProperties(n,{def:{set:function(c){"function"===typeof c&&(this._.synthdef=c)},get:function(){return this._.synthdef}},poly:{set:function(c){"number"===typeof c&&0<c&&64>=c&&(this._.poly=c)},get:function(){return this._.poly}}});var g=function(c,
f){return function(){c._.remGen(f.gen)}},e=function(c){return function(f){var m=c._,k=m.genList.indexOf(f);-1!==k&&m.genList.splice(k,1);"undefined"!==typeof f.noteNum&&(m.genDict[f.noteNum]=null)}},a=function(c,f,m,k){m|=0;0>=m?this.noteOff(this,c):127<m&&(m=127);var l=this._,r=l.genList,w=l.genDict,z=w[c];z&&l.remGen(z);f={freq:f,noteNum:c,velocity:m,mul:.0078125*m};if(k)for(var C in k)f[C]=k[C];f.doneAction=g(this,f);z=l.synthdef.call(this,f);z instanceof u.Object&&(z.noteNum=c,r.push(z),w[c]=
f.gen=z,this.playbackState=h.PLAYING_STATE,r.length>l.poly&&l.remGen(r[0]))},d=function(){for(var c=new Float32Array(128),f=0;128>f;++f)c[f]=440*Math.pow(2,(f-69)/12);return c}();n.noteOn=function(c,f,m){a.call(this,c+.5|0,d[c]||440*Math.pow(2,(c-69)/12),f,m);return this};n.noteOff=function(c){(c=this._.genDict[c])&&c.release&&c.release();return this};n.noteOnWithFreq=function(c,f,m){a.call(this,(0<c?Math.log(1*c/440)*Math.LOG2E*12+69:0)+.5|0,c,f,m);return this};n.noteOffWithFreq=function(c){return this.noteOff((0<
c?Math.log(1*c/440)*Math.LOG2E*12+69:0)+.5|0)};n.allNoteOff=function(){for(var c=this._.genList,f=0,m=c.length;f<m;++f)c[f].release&&c[f].release()};n.allSoundOff=function(){var c=this._,f=c.genList;for(c=c.genDict;f.length;)delete c[f.shift().noteNum]};n.synth=function(c){var f=this._,m=f.genList,k={};if(c)for(var l in c)k[l]=c[l];k.doneAction=g(this,k);c=f.synthdef.call(this,k);c instanceof u.Object&&(m.push(c),k.gen=c,this.playbackState=h.PLAYING_STATE,m.length>f.poly&&f.remGen(m[0]));return this};
n.process=function(c){var f=this.cells[0],m=this._;if(this.tickID!==c){this.tickID=c;if(this.playbackState===h.PLAYING_STATE){var k=m.genList,l=this.cells[1],r=this.cells[2],w;f=f.length;if(k.length){var z=k[0];z.process(c);l.set(z.cells[1]);r.set(z.cells[2]);m=1;for(w=k.length;m<w;++m){z=k[m];z.process(c);var C=z.cells[1];var F=z.cells[2];for(z=0;z<f;++z)l[z]+=C[z],r[z]+=F[z]}}else h.nextTick(m.onended)}h.outputSignalAR(this)}return this};h.register("SynthDef",t);var b={set:function(c){h.isDictionary(c)?
"string"===typeof c.type&&(this._.env=c):c instanceof u.Object&&(this._.env=c)},get:function(){return this._.env}};h.register("OscGen",function(){var c={set:function(k){k instanceof u.Object&&(this._.osc=k)},get:function(){return this._.osc}},f={set:function(k){"string"===typeof k&&(this._.wave=k)},get:function(){return this._.wave}},m=function(k){var l=this._;var r=l.osc||null;var w=l.env||{};var z=w.type||"perc";r instanceof u.Object&&"function"===typeof r.clone&&(r=r.clone());r||=u("osc",{wave:l.wave});
r.freq=k.freq;r.mul=r.mul*k.velocity/128;l=r;w instanceof u.Object?"function"===typeof w.clone&&(l=w.clone().append(l)):l=u(z,w,l);l.on("ended",k.doneAction).bang();return l};return function(k){k=new t(k);k._.wave="sin";Object.defineProperties(k,{env:b,osc:c,wave:f});k.def=m;return k}}());h.register("PluckGen",function(){var c=function(f){var m=this._.env||{};var k=m.type||"perc";var l=u("pluck",{freq:f.freq,mul:f.velocity/128}).bang();m instanceof u.Object?"function"===typeof m.clone&&(l=m.clone().append(l)):
l=u(k,m,l);l.on("ended",f.doneAction).bang();return l};return function(f){f=new t(f);Object.defineProperties(f,{env:b});f.def=c;return f}}())})(timbre);
(function(u){function t(b){u.Object.call(this,2,b);h.fixAR(this);b=this._;b.isLooped=!1;b.onended=h.make_onended(this,0)}var h=u.fn,n=u.modules.Scissor,g=n.Tape,e=n.TapeStream,a=h.isSignalArray;h.extend(t);var d=t.prototype;Object.defineProperties(d,{tape:{set:function(b){b instanceof g?(this.playbackState=h.PLAYING_STATE,this._.tape=b,this._.tapeStream=new e(b,this._.samplerate),this._.tapeStream.isLooped=this._.isLooped):(b instanceof u.Object&&b.buffer&&(b=b.buffer),"object"===typeof b&&Array.isArray(b.buffer)&&
a(b.buffer[0])&&(this.playbackState=h.PLAYING_STATE,this._.tape=new n(b),this._.tapeStream=new e(this._.tape,this._.samplerate),this._.tapeStream.isLooped=this._.isLooped))},get:function(){return this._.tape}},isLooped:{get:function(){return this._.isLooped}},buffer:{get:function(){if(this._.tape)return this._.tape.getBuffer()}}});d.loop=function(b){this._.isLooped=!!b;this._.tapeStream&&(this._.tapeStream.isLooped=this._.isLooped);return this};d.bang=function(){this.playbackState=h.PLAYING_STATE;
this._.tapeStream&&this._.tapeStream.reset();this._.emit("bang");return this};d.getBuffer=function(){if(this._.tape)return this._.tape.getBuffer()};d.process=function(b){var c=this._;if(this.tickID!==b){this.tickID=b;if(b=c.tapeStream){var f=this.cells[1],m=this.cells[2],k=b.fetch(f.length);f.set(k[0]);m.set(k[1]);this.playbackState===h.PLAYING_STATE&&b.isEnded&&h.nextTick(c.onended)}h.outputSignalAR(this)}return this};h.register("tape",t)})(timbre);
(function(u){function t(b){u.Object.call(this,1,b);h.timer(this);b=this._;this.playbackState=h.FINISHED_STATE;b.task=[];b.i=0;b.j=0;b.imax=0;b.jmax=0;b.wait=0;b.count=0;b.args={};b.doNum=1;b.initFunc=h.nop;b.onended=a(this);this.on("start",e)}var h=u.fn,n=u.timevalue,g=u(function(){}).constructor;h.extend(t);var e=function(){var b=this._;this.playbackState=h.PLAYING_STATE;b.task=this.nodes.map(function(f){return f instanceof g?f.func:!1}).filter(function(f){return!!f});b.i=b.j=0;b.imax=b.doNum;b.jmax=
b.task.length;var c=b.initFunc();h.isDictionary(c)||(c={param:c});b.args=c},a=function(b){return function(){b.playbackState=h.FINISHED_STATE;var c=b._,f=b.cells[0],m=b.cells[1],k=b.cells[2],l=c.args;if("number"===typeof l)for(var r=0,w=m.length;r<w;++r)f[0]=m[r]=k[r]=l;c.emit("ended",c.args)}},d=t.prototype;Object.defineProperties(d,{"do":{set:function(b){"number"===typeof b&&0<b&&(this._.doNum=Infinity===b?Infinity:b|0)},get:function(){return this._.doNum}},init:{set:function(b){"function"===typeof b&&
(this._.initFunc=b)},get:function(){return this._.initFunc}}});d.bang=function(){var b=this._;b.count=0;b.emit("bang");return this};d.wait=function(b){"string"===typeof b&&(b=n(b));"number"===typeof b&&0<b&&(this._.count+=this._.samplerate*b*.001|0);return this};d.process=function(b){var c=this.cells[0],f=this._;if(this.tickID!==b&&(this.tickID=b,f.i<f.imax)){for(;0>=f.count;){if(f.j>=f.jmax){++f.i;if(f.i>=f.imax){h.nextTick(f.onended);break}f.j=0}(b=f.task[f.j++])&&b.call(this,f.i,f.args)}f.count-=
c.length}return this};h.register("task",t)})(timbre);
(function(u){function t(d){u.Object.call(this,0,d);h.timer(this);h.fixKR(this);d=this._;this.playbackState=h.FINISHED_STATE;d.currentTime=0;d.samplesMax=0;d.samples=0;d.onended=h.make_onended(this);this.once("init",g);this.on("start",e)}var h=u.fn,n=u.timevalue;h.extend(t);var g=function(){this._.timeout||(this.timeout=1E3)},e=function(){this.playbackState=h.PLAYING_STATE};Object.defineProperty(e,"unremovable",{value:!0,writable:!1});var a=t.prototype;Object.defineProperties(a,{timeout:{set:function(d){var b=
this._;"string"===typeof d&&(d=n(d));"number"===typeof d&&0<=d&&(this.playbackState=h.PLAYING_STATE,b.timeout=d,b.samplesMax=.001*b.samplerate*d|0,b.samples=b.samplesMax)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}});a.bang=function(){var d=this._;this.playbackState=h.PLAYING_STATE;d.samples=d.samplesMax;d.currentTime=0;d.emit("bang");return this};a.process=function(d){var b=this.cells[0],c=this._;if(this.tickID!==d){this.tickID=d;0<c.samples&&(c.samples-=
b.length);if(0>=c.samples){d=this.nodes;b=0;for(var f=d.length;b<f;++b)d[b].bang();h.nextTick(c.onended)}c.currentTime+=h.currentTimeIncr}return this};h.register("timeout",t)})(timbre);
(function(u){function t(g){u.Object.call(this,1,g);h.fixAR(this);this._.curve=null}var h=u.fn;h.extend(t);var n=t.prototype;Object.defineProperties(n,{curve:{set:function(g){h.isSignalArray(g)&&(this._.curve=g)},get:function(){return this._.curve}}});n.process=function(g){var e=this._;if(this.tickID!==g){this.tickID=g;h.inputSignalAR(this);if(e.curve){g=this.cells[0];var a=e.curve,d=a.length,b,c=e.cellsize;for(b=0;b<c;++b)e=.5*(g[b]+1)*d+.5|0,0>e?e=0:e>=d-1&&(e=d-1),g[b]=a[e]}h.outputSignalAR(this)}return this};
h.register("waveshaper",t)})(timbre);
(function(u){function t(a){u.Object.call(this,1,a);a=this._;a.inMin=0;a.inMax=1;a.outMin=0;a.outMax=1;a.ar=!1;this.once("init",n)}var h=u.fn;h.extend(t);var n=function(){this._.warp||(this.warp="linlin")},g=t.prototype;Object.defineProperties(g,{inMin:{set:function(a){"number"===typeof a&&(this._.inMin=a)},get:function(){return this._.inMin}},inMax:{set:function(a){"number"===typeof a&&(this._.inMax=a)},get:function(){return this._.inMax}},outMin:{set:function(a){"number"===typeof a&&(this._.outMin=
a)},get:function(){return this._.outMin}},outMax:{set:function(a){"number"===typeof a&&(this._.outMax=a)},get:function(){return this._.outMax}},warp:{set:function(a){if("string"===typeof a){var d=e[a];d&&(this._.warp=d,this._.warpName=a)}},get:function(){return this._.warpName}}});g.process=function(a){var d=this._,b=this.cells[0];if(this.tickID!==a){this.tickID=a;var c=d.inMin,f=d.inMax,m=d.outMin,k=d.outMax,l=d.warp,r=this.nodes.length,w=d.mul,z=d.add;a=b.length;if(d.ar&&r){h.inputSignalAR(this);
for(d=0;d<a;++d)b[d]=l(b[d],c,f,m,k)*w+z;h.outputSignalAR(this)}else for(d=this.nodes.length?h.inputSignalKR(this):0,c=l(d,c,f,m,k)*w+z,d=0;d<a;++d)b[d]=c}return this};var e={linlin:function(a,d,b,c,f){return a<d?c:a>b?f:b===d?c:(a-d)/(b-d)*(f-c)+c},linexp:function(a,d,b,c,f){return a<d?c:a>b?f:0===c?0:b===d?f:Math.pow(f/c,(a-d)/(b-d))*c},explin:function(a,d,b,c,f){return a<d?c:a>b?f:0===d?f:Math.log(a/d)/Math.log(b/d)*(f-c)+c},expexp:function(a,d,b,c,f){return a<d?c:a>b?f:0===d||0===c?0:Math.pow(f/
c,Math.log(a/d)/Math.log(b/d))*c}};h.register("zmap",t)})(timbre);
